-- =============================================
-- CLOUD SECURITY TRAINING DATABASE SEED
-- Run this after creating the schema
-- =============================================

-- Insert Courses
INSERT INTO courses (id, title, description, category, difficulty, duration_minutes, passing_score, is_published) VALUES
('11111111-1111-1111-1111-111111111111', 'Cloud Security Fundamentals', 'Learn the essential concepts of cloud security including shared responsibility, IAM basics, and data protection principles.', 'General', 'Beginner', 60, 70, true),
('22222222-2222-2222-2222-222222222222', 'AWS Security Best Practices', 'Master AWS security services including IAM, S3 security, VPC, CloudTrail, and KMS.', 'AWS', 'Intermediate', 90, 70, true),
('33333333-3333-3333-3333-333333333333', 'Azure Security Essentials', 'Learn Azure security fundamentals including Azure AD, RBAC, NSGs, and Key Vault.', 'Azure', 'Intermediate', 75, 70, true),
('d4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f80', 'GCP Security Fundamentals', 'Learn the essentials of Google Cloud Platform security including IAM, VPC security, and monitoring.', 'GCP', 'Beginner', 60, 70, true),
('e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8091', 'Kubernetes Security', 'Master container security with RBAC, pod security, network policies, and runtime protection.', 'General', 'Advanced', 90, 75, true),
('f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f809102', 'Zero Trust Architecture', 'Implement zero trust security principles in cloud environments with identity-centric approaches.', 'General', 'Advanced', 75, 75, true),
('a7b8c9d0-e1f2-4a3b-4c5d-6e7f80910213', 'Cloud Compliance & Governance', 'Navigate GDPR, SOC 2, ISO 27001, and PCI DSS compliance requirements in cloud environments.', 'General', 'Intermediate', 80, 70, true),
('b8c9d0e1-f2a3-4b4c-5d6e-7f8091021324', 'AWS Advanced Security', 'Advanced AWS security with Organizations, GuardDuty, Security Hub, WAF, and incident response.', 'AWS', 'Advanced', 100, 75, true);

-- Insert Quizzes
INSERT INTO quizzes (id, course_id, title, description, time_limit_minutes, max_attempts) VALUES
('aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa', '11111111-1111-1111-1111-111111111111', 'Cloud Security Fundamentals Quiz', 'Test your knowledge of cloud security fundamentals', 15, 3),
('bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb', '22222222-2222-2222-2222-222222222222', 'AWS Security Best Practices Quiz', 'Test your AWS security knowledge', 20, 3),
('cccccccc-cccc-cccc-cccc-cccccccccccc', '33333333-3333-3333-3333-333333333333', 'Azure Security Essentials Quiz', 'Test your Azure security knowledge', 15, 3),
('04d5e6f7-a8b9-4c0d-1e2f-3a4b5c6d7e80', 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f80', 'GCP Security Fundamentals Quiz', 'Test your knowledge of Google Cloud Platform security fundamentals.', 20, 3),
('05e6f7a8-b9c0-4d1e-2f3a-4b5c6d7e8f91', 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8091', 'Kubernetes Security Quiz', 'Demonstrate your understanding of Kubernetes security concepts.', 25, 3),
('06f7a8b9-c0d1-4e2f-3a4b-5c6d7e8f9012', 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f809102', 'Zero Trust Architecture Quiz', 'Validate your knowledge of zero trust security principles.', 20, 3),
('07a8b9c0-d1e2-4f3a-4b5c-6d7e8f901223', 'a7b8c9d0-e1f2-4a3b-4c5d-6e7f80910213', 'Cloud Compliance Quiz', 'Test your understanding of cloud compliance frameworks.', 25, 3),
('08b9c0d1-e2f3-4a4b-5c6d-7e8f90122334', 'b8c9d0e1-f2a3-4b4c-5d6e-7f8091021324', 'AWS Advanced Security Quiz', 'Demonstrate mastery of advanced AWS security concepts.', 30, 3);

-- =============================================
-- LESSONS - Cloud Security Fundamentals
-- =============================================
INSERT INTO lessons (id, course_id, title, content, order_index, duration_minutes) VALUES
('2aa188db-ffe8-4fd8-85d9-af26af54b032', '11111111-1111-1111-1111-111111111111', 'Introduction to Cloud Security', E'# Introduction to Cloud Security\n\nCloud security refers to the set of policies, technologies, and controls deployed to protect data, applications, and infrastructure in cloud computing environments.\n\n## Why Cloud Security Matters\n\n- **Data Protection**: Sensitive data stored in the cloud needs robust protection\n- **Compliance**: Organizations must meet regulatory requirements\n- **Business Continuity**: Security breaches can disrupt operations\n- **Reputation**: Data breaches damage customer trust\n\n## Key Concepts\n\n1. **Confidentiality**: Ensuring data is only accessible to authorized users\n2. **Integrity**: Maintaining data accuracy and consistency\n3. **Availability**: Ensuring systems are accessible when needed\n\n## Cloud Deployment Models\n\n- **Public Cloud**: Resources shared among multiple tenants\n- **Private Cloud**: Dedicated infrastructure for one organization\n- **Hybrid Cloud**: Combination of public and private clouds\n- **Multi-Cloud**: Using multiple cloud providers', 1, 10),

('4bd2aeb7-aebe-4999-88ef-21d7fa051cc9', '11111111-1111-1111-1111-111111111111', 'Shared Responsibility Model', E'# The Shared Responsibility Model\n\nThe shared responsibility model defines the security obligations of cloud providers and customers.\n\n## Provider Responsibilities\n\nCloud providers are typically responsible for:\n- Physical security of data centers\n- Network infrastructure\n- Hypervisor security\n- Hardware maintenance\n\n## Customer Responsibilities\n\nCustomers are typically responsible for:\n- Data classification and encryption\n- Identity and access management\n- Application security\n- Network configuration\n- Operating system patches (IaaS)\n\n## Model Variations by Service Type\n\n### IaaS (Infrastructure as a Service)\nCustomer manages: OS, middleware, runtime, data, applications\n\n### PaaS (Platform as a Service)\nCustomer manages: Data, applications\n\n### SaaS (Software as a Service)\nCustomer manages: Data, user access\n\n## Best Practices\n\n1. Understand your provider''s security controls\n2. Document security responsibilities clearly\n3. Implement security monitoring\n4. Regular security assessments', 2, 15),

('0ce4066c-ab88-4fa8-a0c8-4e58f204de7d', '11111111-1111-1111-1111-111111111111', 'Identity and Access Management Basics', E'# Identity and Access Management (IAM)\n\nIAM is a framework for managing digital identities and controlling access to resources.\n\n## Core IAM Concepts\n\n### Authentication\nVerifying the identity of users or systems:\n- Passwords\n- Multi-factor authentication (MFA)\n- Biometrics\n- Certificates\n\n### Authorization\nDetermining what actions authenticated users can perform:\n- Role-based access control (RBAC)\n- Attribute-based access control (ABAC)\n- Policy-based access control\n\n## Principle of Least Privilege\n\nUsers should only have the minimum permissions necessary to perform their job functions.\n\n### Implementation Tips:\n1. Start with no permissions\n2. Add permissions as needed\n3. Regularly review and revoke unused permissions\n4. Use time-limited access for sensitive operations\n\n## IAM Best Practices\n\n- Enable MFA for all users\n- Use strong password policies\n- Implement regular access reviews\n- Avoid using root/admin accounts for daily tasks\n- Monitor authentication logs', 3, 12),

('3f5eb028-1bfe-4c4a-9953-63bf35524a37', '11111111-1111-1111-1111-111111111111', 'Network Security Fundamentals', E'# Network Security in the Cloud\n\nProtecting network infrastructure and data in transit is crucial for cloud security.\n\n## Key Network Security Controls\n\n### Virtual Private Cloud (VPC)\nIsolated network environments within the cloud:\n- Subnets for network segmentation\n- Route tables for traffic control\n- Internet gateways for external access\n\n### Security Groups\nVirtual firewalls for instances:\n- Stateful packet filtering\n- Inbound and outbound rules\n- Applied at instance level\n\n### Network Access Control Lists (NACLs)\nSubnet-level security:\n- Stateless packet filtering\n- Allow and deny rules\n- Applied at subnet level\n\n## Encryption in Transit\n\n- TLS/SSL for web traffic\n- VPN for site-to-site connectivity\n- Private endpoints for cloud services\n\n## Network Monitoring\n\n1. Flow logs for traffic analysis\n2. Intrusion detection systems\n3. DDoS protection services\n4. Web application firewalls', 4, 12),

('de3257a8-8279-4dd0-9dc2-a641580152b2', '11111111-1111-1111-1111-111111111111', 'Data Protection Basics', E'# Data Protection in the Cloud\n\nProtecting data at rest and in transit is fundamental to cloud security.\n\n## Data Classification\n\nCategorize data based on sensitivity:\n- **Public**: No restrictions\n- **Internal**: Business use only\n- **Confidential**: Limited access\n- **Restricted**: Highly sensitive\n\n## Encryption at Rest\n\nProtecting stored data:\n- Server-side encryption (SSE)\n- Client-side encryption\n- Key management services\n- Hardware security modules (HSM)\n\n## Encryption Key Management\n\n### Best Practices:\n1. Use managed key services\n2. Rotate keys regularly\n3. Separate key management from data\n4. Implement key access logging\n\n## Data Backup and Recovery\n\n- Regular automated backups\n- Geographic redundancy\n- Tested recovery procedures\n- Retention policies\n\n## Data Loss Prevention (DLP)\n\n- Content inspection\n- Policy enforcement\n- Activity monitoring\n- Incident response\n\n## Compliance Considerations\n\n- GDPR for personal data\n- HIPAA for healthcare\n- PCI-DSS for payment data\n- SOC 2 for service organizations', 5, 11);

-- =============================================
-- LESSONS - AWS Security Best Practices
-- =============================================
INSERT INTO lessons (id, course_id, title, content, order_index, duration_minutes) VALUES
('f1832aa4-957a-432d-9bdb-08c7cea8cd46', '22222222-2222-2222-2222-222222222222', 'AWS IAM Deep Dive', E'# AWS Identity and Access Management (IAM)\n\nAWS IAM enables you to manage access to AWS services and resources securely.\n\n## IAM Components\n\n### Users\nIndividual identities with long-term credentials:\n- Console access with passwords\n- Programmatic access with access keys\n- MFA for additional security\n\n### Groups\nCollections of users with shared permissions:\n- Simplifies permission management\n- Users inherit group policies\n- A user can belong to multiple groups\n\n### Roles\nTemporary credentials for AWS resources:\n- No long-term credentials\n- Assumed by users, services, or applications\n- Cross-account access\n- Federation with external identity providers\n\n### Policies\nJSON documents defining permissions:\n```json\n{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Action": "s3:GetObject",\n      "Resource": "arn:aws:s3:::bucket-name/*"\n    }\n  ]\n}\n```\n\n## IAM Best Practices\n\n1. Delete root access keys\n2. Create individual IAM users\n3. Use groups to assign permissions\n4. Enable MFA\n5. Use roles for applications\n6. Rotate credentials regularly\n7. Use policy conditions for extra security', 1, 15),

('5d17e3ea-2e12-4ac0-8c44-b481876fe485', '22222222-2222-2222-2222-222222222222', 'S3 Security Configuration', E'# Amazon S3 Security\n\nSecuring your S3 buckets and objects is critical for data protection.\n\n## S3 Access Controls\n\n### Bucket Policies\nResource-based policies attached to buckets:\n- Control access for all objects\n- Allow cross-account access\n- Enforce encryption requirements\n\n### Access Control Lists (ACLs)\nLegacy access control mechanism:\n- Bucket and object level\n- Limited compared to policies\n- Recommended to disable\n\n### Block Public Access\nAccount and bucket-level settings:\n- BlockPublicAcls\n- IgnorePublicAcls\n- BlockPublicPolicy\n- RestrictPublicBuckets\n\n## S3 Encryption\n\n### Server-Side Encryption (SSE)\n- **SSE-S3**: Amazon manages keys\n- **SSE-KMS**: AWS KMS manages keys\n- **SSE-C**: Customer provides keys\n\n### Client-Side Encryption\nEncrypt before uploading to S3\n\n## S3 Security Best Practices\n\n1. Enable default encryption\n2. Block public access\n3. Use VPC endpoints\n4. Enable versioning\n5. Enable access logging\n6. Use S3 Object Lock for compliance', 2, 15),

('e2dcc41f-c25c-4be9-bd45-19dd5eba7e73', '22222222-2222-2222-2222-222222222222', 'VPC and Network Security', E'# AWS VPC Security\n\nAmazon VPC lets you provision a logically isolated section of AWS.\n\n## VPC Components\n\n### Subnets\n- Public subnets: Internet accessible\n- Private subnets: No direct internet access\n\n### Route Tables\nControl traffic routing between subnets and gateways\n\n### Internet Gateway\nEnables internet connectivity for public subnets\n\n### NAT Gateway\nAllows private subnet resources to access internet\n\n## Security Controls\n\n### Security Groups\n- Instance-level firewall\n- Stateful\n- Allow rules only\n\n### Network ACLs\n- Subnet-level firewall\n- Stateless\n- Allow and deny rules\n\n### VPC Flow Logs\nCapture IP traffic information:\n- Accepted and rejected traffic\n- Source and destination\n- Ports and protocols\n\n## Advanced VPC Security\n\n### VPC Endpoints\nPrivate connectivity to AWS services:\n- Gateway endpoints (S3, DynamoDB)\n- Interface endpoints (other services)\n\n### AWS PrivateLink\nExpose services privately across VPCs\n\n### AWS Transit Gateway\nCentral hub for VPC connectivity', 3, 15),

('d02f1704-01fc-4ba9-bf73-df378eaa28fe', '22222222-2222-2222-2222-222222222222', 'CloudTrail and Logging', E'# AWS CloudTrail\n\nCloudTrail records AWS API calls for your account.\n\n## CloudTrail Features\n\n### Management Events\n- Control plane operations\n- CreateBucket, RunInstances, etc.\n- Enabled by default\n\n### Data Events\n- Data plane operations\n- S3 object operations\n- Lambda invocations\n- Not enabled by default\n\n### Insights Events\n- Unusual API activity detection\n- Identifies anomalies\n\n## CloudTrail Best Practices\n\n1. Enable in all regions\n2. Store logs in dedicated S3 bucket\n3. Enable log file validation\n4. Encrypt logs with KMS\n5. Enable multi-region trail\n6. Set up CloudWatch alarms\n\n## Log Analysis\n\n### CloudWatch Logs Integration\n- Real-time log analysis\n- Metric filters\n- Alerting\n\n### Athena Queries\nQuery CloudTrail logs using SQL:\n```sql\nSELECT eventname, useridentity.username\nFROM cloudtrail_logs\nWHERE eventtime > ''2024-01-01''\n```\n\n## Other AWS Logging Services\n\n- VPC Flow Logs\n- S3 Access Logs\n- ELB Access Logs\n- CloudFront Logs', 4, 15),

('ed26442d-becb-47cb-80b0-f0ac4ba608d1', '22222222-2222-2222-2222-222222222222', 'KMS and Encryption', E'# AWS Key Management Service (KMS)\n\nKMS makes it easy to create and manage cryptographic keys.\n\n## KMS Key Types\n\n### AWS Managed Keys\n- Created automatically by AWS services\n- Rotated annually\n- Cannot modify permissions\n\n### Customer Managed Keys\n- Full control over key policies\n- Enable/disable rotation\n- Can be deleted\n\n### AWS Owned Keys\n- Used by AWS in shared accounts\n- Not visible in your account\n\n## Key Policies\n\nControl access to KMS keys:\n```json\n{\n  "Sid": "Allow use of the key",\n  "Effect": "Allow",\n  "Principal": {"AWS": "arn:aws:iam::111122223333:role/ExampleRole"},\n  "Action": ["kms:Encrypt", "kms:Decrypt"],\n  "Resource": "*"\n}\n```\n\n## Envelope Encryption\n\n1. Generate data key from CMK\n2. Use data key to encrypt data\n3. Store encrypted data key with data\n4. Use CMK to decrypt data key when needed\n\n## KMS Best Practices\n\n1. Use key aliases for identification\n2. Enable automatic key rotation\n3. Use grants for temporary access\n4. Monitor key usage with CloudTrail\n5. Implement proper key policies', 5, 15),

('87ad4de3-7b68-4171-83e0-3aa2d1798ff9', '22222222-2222-2222-2222-222222222222', 'Security Hub Overview', E'# AWS Security Hub\n\nSecurity Hub provides a comprehensive view of security alerts and posture.\n\n## Key Features\n\n### Security Standards\nBuilt-in compliance checks:\n- AWS Foundational Security Best Practices\n- CIS AWS Foundations Benchmark\n- PCI DSS\n\n### Findings Aggregation\nCollect findings from multiple sources:\n- GuardDuty\n- Inspector\n- Macie\n- Third-party tools\n\n### Automated Response\nIntegrate with EventBridge and Lambda for automation\n\n## Security Hub Components\n\n### Insights\nPre-defined and custom groupings of findings:\n- Critical findings by resource\n- Findings by AWS account\n- Publicly accessible resources\n\n### Controls\nIndividual security checks:\n- Severity levels\n- Remediation guidance\n- Resource details\n\n## Best Practices\n\n1. Enable in all regions\n2. Enable all security standards\n3. Set up cross-account aggregation\n4. Configure automated remediation\n5. Regularly review insights\n6. Integrate with ticketing systems\n\n## Pricing Considerations\n\n- Charged per security check\n- Charged per finding ingested\n- Consider costs in multi-account setups', 6, 15);

-- =============================================
-- LESSONS - Azure Security Essentials
-- =============================================
INSERT INTO lessons (id, course_id, title, content, order_index, duration_minutes) VALUES
('039d79b7-e0af-4cf5-972f-ad9ff99c9ae7', '33333333-3333-3333-3333-333333333333', 'Azure AD and RBAC', E'# Azure Active Directory and RBAC\n\nAzure AD is Microsoft''s cloud-based identity and access management service.\n\n## Azure AD Features\n\n### Identity Management\n- User and group management\n- Self-service password reset\n- Multi-factor authentication\n- Conditional Access policies\n\n### Application Integration\n- Single sign-on (SSO)\n- Enterprise applications\n- App registrations\n\n## Azure RBAC\n\nRole-Based Access Control for Azure resources:\n\n### Built-in Roles\n- **Owner**: Full access, can delegate\n- **Contributor**: Full access, cannot delegate\n- **Reader**: View only access\n- **User Access Administrator**: Manage user access\n\n### Custom Roles\nCreate roles with specific permissions:\n```json\n{\n  "Name": "Custom Role",\n  "Actions": ["Microsoft.Compute/virtualMachines/read"],\n  "NotActions": [],\n  "AssignableScopes": ["/subscriptions/xxx"]\n}\n```\n\n### Scope Levels\n- Management group\n- Subscription\n- Resource group\n- Resource\n\n## Best Practices\n\n1. Use Privileged Identity Management (PIM)\n2. Enable MFA for all users\n3. Use Conditional Access\n4. Implement just-in-time access\n5. Regular access reviews', 1, 15),

('b211bcfc-c8c9-4f92-b23e-de662e5ac28d', '33333333-3333-3333-3333-333333333333', 'Azure Storage Security', E'# Azure Storage Security\n\nProtecting your Azure Storage accounts and data.\n\n## Authentication Methods\n\n### Shared Key\n- Account key access\n- Full account permissions\n- Should be rotated regularly\n\n### Shared Access Signatures (SAS)\n- Delegated access to resources\n- Time-limited\n- Can restrict to specific operations\n\n### Azure AD Authentication\n- RBAC-based access\n- Recommended for applications\n- No key management required\n\n## Data Protection\n\n### Encryption at Rest\n- Storage Service Encryption (SSE)\n- Microsoft-managed or customer-managed keys\n- Enabled by default\n\n### Encryption in Transit\n- HTTPS required\n- SMB 3.0 encryption for file shares\n\n## Network Security\n\n### Service Endpoints\n- Private access from VNets\n- Traffic stays on Azure backbone\n\n### Private Endpoints\n- Private IP in your VNet\n- Fully isolated access\n\n### Firewalls\n- IP-based restrictions\n- VNet rules\n\n## Best Practices\n\n1. Disable public access when possible\n2. Use SAS tokens instead of account keys\n3. Enable soft delete for data protection\n4. Use immutable storage for compliance\n5. Enable advanced threat protection', 2, 15),

('33b77026-8d9d-40d3-bebb-d5d9799f637c', '33333333-3333-3333-3333-333333333333', 'Network Security Groups', E'# Azure Network Security Groups\n\nNSGs filter network traffic to and from Azure resources.\n\n## NSG Basics\n\n### Components\n- **Security Rules**: Allow or deny traffic\n- **Priority**: Lower number = higher priority\n- **Direction**: Inbound or outbound\n\n### Default Rules\nBuilt-in rules that cannot be deleted:\n- AllowVNetInBound\n- AllowAzureLoadBalancerInBound\n- DenyAllInBound (lowest priority)\n\n## Rule Properties\n\n```\nPriority: 100\nName: AllowHTTPS\nSource: Any\nDestination: VirtualNetwork\nPort: 443\nProtocol: TCP\nAction: Allow\n```\n\n## Application Security Groups\n\nGroup VMs for easier rule management:\n- Apply rules to groups, not individual IPs\n- Simplified management\n- Better organization\n\n## NSG Flow Logs\n\nMonitor and analyze traffic:\n- Source and destination\n- Ports and protocols\n- Allow/deny decisions\n- Integration with Azure Monitor\n\n## Best Practices\n\n1. Use ASGs for grouping\n2. Minimize rules with broad scopes\n3. Enable flow logs\n4. Document rule purposes\n5. Regular rule review\n6. Use just-in-time VM access', 3, 15),

('9dd88921-e605-4fb4-b190-5dfb2b80f937', '33333333-3333-3333-3333-333333333333', 'Azure Monitor and Defender', E'# Azure Monitor and Microsoft Defender for Cloud\n\nComprehensive monitoring and security management.\n\n## Azure Monitor\n\n### Data Sources\n- Metrics\n- Logs\n- Traces\n\n### Key Components\n\n**Log Analytics Workspace**\n- Central log repository\n- Kusto Query Language (KQL)\n- Retention policies\n\n**Alerts**\n- Metric alerts\n- Log alerts\n- Activity log alerts\n\n**Workbooks**\n- Interactive reports\n- Data visualization\n\n## Microsoft Defender for Cloud\n\n### Features\n- Security posture management\n- Threat protection\n- Compliance management\n\n### Security Score\n- 0-100 score\n- Based on recommendations\n- Prioritized remediation\n\n### Recommendations\n- Grouped by control\n- Implementation guidance\n- Quick fixes available\n\n### Cloud Workload Protection\n\n**Defender Plans:**\n- Defender for Servers\n- Defender for Storage\n- Defender for SQL\n- Defender for Containers\n- Defender for Key Vault\n\n## Best Practices\n\n1. Enable Defender for all workloads\n2. Address critical recommendations first\n3. Set up security alerts\n4. Regular security review\n5. Export data to SIEM', 4, 15),

('2e99e487-cea9-406a-be29-0c0037636a44', '33333333-3333-3333-3333-333333333333', 'Key Vault Management', E'# Azure Key Vault\n\nCentralized secrets management for Azure.\n\n## Key Vault Features\n\n### Secrets\n- Store connection strings\n- API keys\n- Passwords\n\n### Keys\n- Cryptographic keys\n- RSA and EC keys\n- Hardware-backed (HSM)\n\n### Certificates\n- SSL/TLS certificates\n- Auto-renewal\n- Integration with CAs\n\n## Access Control\n\n### Access Policies\n- Traditional access model\n- Per-principal permissions\n- Key, secret, certificate permissions\n\n### RBAC (Recommended)\n- Azure AD-based\n- Fine-grained control\n- Built-in roles:\n  - Key Vault Administrator\n  - Key Vault Secrets User\n  - Key Vault Crypto User\n\n## Security Features\n\n### Soft Delete\n- Recover deleted items\n- Configurable retention\n- Enabled by default\n\n### Purge Protection\n- Prevent permanent deletion\n- Cannot be disabled once enabled\n\n### Private Endpoint\n- Private network access\n- No public internet exposure\n\n## Best Practices\n\n1. Use managed identities\n2. Enable soft delete and purge protection\n3. Use separate vaults per environment\n4. Enable logging\n5. Rotate secrets regularly\n6. Use private endpoints', 5, 15);

-- =============================================
-- LESSONS - GCP Security Fundamentals
-- =============================================
INSERT INTO lessons (id, course_id, title, content, order_index, duration_minutes) VALUES
('fcf33dae-e9e1-4167-addc-a6e016a0ce53', 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f80', 'Introduction to Google Cloud Security', E'# Introduction to Google Cloud Security\n\nGoogle Cloud Platform (GCP) provides a comprehensive set of security tools and services to protect your cloud infrastructure.\n\n## GCP Security Model\n\nGCP follows a **shared responsibility model** where Google secures the underlying infrastructure while customers secure their workloads.\n\n### Google''s Responsibilities\n- Physical security of data centers\n- Hardware and firmware security\n- Network infrastructure\n- Encryption of data at rest\n\n### Customer Responsibilities\n- Identity and access management\n- Data classification and protection\n- Application security\n- Network configuration\n\n## Key Security Services\n\n| Service | Purpose |\n|---------|----------|\n| Cloud IAM | Identity and access management |\n| Cloud Armor | DDoS protection and WAF |\n| Security Command Center | Security posture management |\n| Cloud KMS | Key management |\n| VPC Service Controls | Data exfiltration prevention |\n\n## Security Principles\n\n1. **Defense in depth**: Multiple layers of security\n2. **Least privilege**: Minimal necessary access\n3. **Zero trust**: Never trust, always verify', 1, 10),

('73f0b250-bb65-4fde-8376-d46e23b7c4f6', 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f80', 'IAM and Cloud Identity', E'# IAM and Cloud Identity\n\n## Cloud Identity\n\nCloud Identity is Google''s identity as a service (IDaaS) solution that manages users and groups.\n\n### Key Features\n- Single sign-on (SSO)\n- Multi-factor authentication\n- Device management\n- Directory synchronization\n\n## Cloud IAM\n\nCloud IAM lets you manage access control by defining **who** (identity) has **what access** (role) for **which resource**.\n\n### IAM Components\n\n```\nMember + Role + Resource = IAM Policy\n```\n\n### Member Types\n- **Google Account**: Individual user\n- **Service Account**: Application identity\n- **Google Group**: Collection of members\n- **Google Workspace domain**: All users in domain\n- **allAuthenticatedUsers**: Any authenticated user\n- **allUsers**: Anyone (public)\n\n### Role Types\n\n| Type | Description | Example |\n|------|-------------|---------|\n| Basic | Broad access | Owner, Editor, Viewer |\n| Predefined | Granular GCP roles | roles/compute.admin |\n| Custom | User-defined | projects/x/roles/custom |\n\n## Best Practices\n\n1. Use **service accounts** for applications\n2. Apply **least privilege** principle\n3. Use **groups** instead of individual users\n4. Enable **audit logging**\n5. Regularly **review** IAM policies', 2, 12),

('6fb68c7c-d26a-4f3b-893c-986d455aa51e', 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f80', 'VPC Security and Firewall Rules', E'# VPC Security and Firewall Rules\n\n## Virtual Private Cloud (VPC)\n\nA VPC provides isolated network space for your GCP resources.\n\n### VPC Features\n- Global resource spanning all regions\n- Subnets are regional\n- Automatic or custom subnet mode\n- Private Google Access\n\n## Firewall Rules\n\nGCP firewall rules control traffic to and from VM instances.\n\n### Rule Components\n\n```yaml\nFirewall Rule:\n  - Name: allow-ssh\n  - Direction: INGRESS\n  - Priority: 1000\n  - Action: ALLOW\n  - Targets: All instances\n  - Source: 0.0.0.0/0\n  - Protocols: tcp:22\n```\n\n### Rule Priority\n- Lower number = higher priority\n- Range: 0 to 65535\n- Default rules have priority 65534-65535\n\n## VPC Service Controls\n\nCreate security perimeters around GCP resources to prevent data exfiltration.\n\n### Perimeter Types\n1. **Regular perimeter**: Protects resources\n2. **Perimeter bridge**: Allows communication between perimeters\n\n## Best Practices\n\n1. Use **private subnets** for sensitive workloads\n2. Implement **network segmentation**\n3. Enable **VPC Flow Logs**\n4. Use **Cloud NAT** for outbound connectivity\n5. Apply **firewall rules** at organization level', 3, 12),

('97bfb979-a57c-4e5c-9866-3af716fac636', 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f80', 'Cloud Storage Security', E'# Cloud Storage Security\n\n## Storage Classes\n\n| Class | Use Case | Availability |\n|-------|----------|--------------|\n| Standard | Frequently accessed | 99.99% |\n| Nearline | Monthly access | 99.9% |\n| Coldline | Quarterly access | 99.9% |\n| Archive | Yearly access | 99.9% |\n\n## Access Control\n\n### Uniform Bucket-Level Access\nRecommended approach using only IAM for access control.\n\n### Fine-Grained Access\nUses both IAM and ACLs (legacy).\n\n## Encryption\n\n### Encryption at Rest\n- **Google-managed**: Default, automatic\n- **Customer-managed (CMEK)**: You control keys in Cloud KMS\n- **Customer-supplied (CSEK)**: You provide keys\n\n### Encryption in Transit\nAll data encrypted using TLS.\n\n## Security Features\n\n### Signed URLs\nTemporary access to objects without authentication.\n\n```python\n# Generate signed URL (valid 15 minutes)\nsigned_url = blob.generate_signed_url(\n    expiration=timedelta(minutes=15),\n    method="GET"\n)\n```\n\n### Object Versioning\nProtect against accidental deletion.\n\n### Retention Policies\nPrevent object deletion for specified period.\n\n## Best Practices\n\n1. Enable **uniform bucket-level access**\n2. Use **CMEK** for sensitive data\n3. Enable **object versioning**\n4. Set **retention policies**\n5. Block **public access** unless required', 4, 14),

('9989d991-1dfb-4e67-bf9f-7c7328d4523b', 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f80', 'Cloud Audit Logs and Monitoring', E'# Cloud Audit Logs and Monitoring\n\n## Cloud Audit Logs\n\nGCP automatically creates audit logs for security-relevant events.\n\n### Log Types\n\n| Type | Contents | Default |\n|------|----------|---------|\n| Admin Activity | Config changes | Always on |\n| Data Access | Data reads/writes | Configurable |\n| System Event | GCP system actions | Always on |\n| Policy Denied | Access denials | Always on |\n\n## Cloud Logging\n\nCentralized logging service for all GCP resources.\n\n### Log Entry Structure\n```json\n{\n  "logName": "projects/my-project/logs/cloudaudit",\n  "resource": {"type": "gce_instance"},\n  "timestamp": "2024-01-15T10:30:00Z",\n  "severity": "INFO",\n  "protoPayload": {...}\n}\n```\n\n### Log-Based Metrics\nCreate custom metrics from log entries for alerting.\n\n## Security Command Center\n\nCentralized security management platform.\n\n### Features\n- Asset inventory\n- Vulnerability detection\n- Threat detection\n- Compliance monitoring\n\n### Findings Categories\n1. **Vulnerabilities**: Misconfigurations\n2. **Threats**: Active attacks\n3. **Errors**: Operational issues\n\n## Cloud Monitoring\n\n### Key Metrics for Security\n- Failed login attempts\n- API error rates\n- Network traffic anomalies\n- Resource utilization spikes\n\n## Best Practices\n\n1. Enable **Data Access logs** for sensitive resources\n2. Export logs to **Cloud Storage** for retention\n3. Create **log-based alerts**\n4. Use **Security Command Center**\n5. Implement **SIEM integration**', 5, 12);

-- =============================================
-- LESSONS - Kubernetes Security
-- =============================================
INSERT INTO lessons (id, course_id, title, content, order_index, duration_minutes) VALUES
('0762ebf1-a09f-428e-9a36-ad8536b6fdf2', 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8091', 'Kubernetes Security Overview', E'# Kubernetes Security Overview\n\n## The 4C''s of Cloud Native Security\n\nSecurity is applied in layers, each protecting the next:\n\n```\n┌─────────────────────────────┐\n│          Code               │\n│    ┌───────────────────┐    │\n│    │    Container      │    │\n│    │  ┌─────────────┐  │    │\n│    │  │   Cluster   │  │    │\n│    │  │ ┌─────────┐ │  │    │\n│    │  │ │  Cloud  │ │  │    │\n│    │  │ └─────────┘ │  │    │\n│    │  └─────────────┘  │    │\n│    └───────────────────┘    │\n└─────────────────────────────┘\n```\n\n## Kubernetes Attack Surface\n\n### Control Plane Components\n- API Server\n- etcd\n- Controller Manager\n- Scheduler\n\n### Node Components\n- Kubelet\n- Container Runtime\n- Kube-proxy\n\n## Common Attack Vectors\n\n| Vector | Risk | Mitigation |\n|--------|------|------------|\n| Exposed API Server | Cluster takeover | Network policies, RBAC |\n| Privileged containers | Node escape | Pod Security Standards |\n| Vulnerable images | Code execution | Image scanning |\n| Secrets in env vars | Data exposure | External secrets |\n\n## Security Principles\n\n1. **Least privilege**: Minimal permissions\n2. **Defense in depth**: Multiple security layers\n3. **Immutability**: Replace, don''t patch\n4. **Observability**: Monitor everything', 1, 15),

('d0608d61-767e-4840-8342-328a42da5e11', 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8091', 'RBAC and Service Accounts', E'# RBAC and Service Accounts\n\n## Role-Based Access Control (RBAC)\n\nRBAC regulates access to Kubernetes resources based on roles.\n\n### RBAC Components\n\n```yaml\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  namespace: default\n  name: pod-reader\nrules:\n- apiGroups: [""]\n  resources: ["pods"]\n  verbs: ["get", "watch", "list"]\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: read-pods\n  namespace: default\nsubjects:\n- kind: User\n  name: jane\n  apiGroup: rbac.authorization.k8s.io\nroleRef:\n  kind: Role\n  name: pod-reader\n  apiGroup: rbac.authorization.k8s.io\n```\n\n### Role vs ClusterRole\n\n| Type | Scope | Use Case |\n|------|-------|---------|\n| Role | Namespace | App-specific access |\n| ClusterRole | Cluster-wide | Admin, node access |\n\n## Service Accounts\n\nEvery pod runs with a service account identity.\n\n### Default Service Account\n- Automatically mounted\n- Usually has no permissions\n- Same account for all pods in namespace\n\n### Best Practices\n\n```yaml\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: my-app\nautomountServiceAccountToken: false\n```\n\n## Security Recommendations\n\n1. **Disable** default service account token mounting\n2. Create **dedicated** service accounts per app\n3. Use **least privilege** roles\n4. Audit RBAC with `kubectl auth can-i`\n5. Use **external identity** providers', 2, 15),

('10d12c8a-6784-40d6-a198-8877159224e5', 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8091', 'Pod Security Standards', E'# Pod Security Standards\n\n## Pod Security Admission\n\nKubernetes built-in admission controller for enforcing security standards.\n\n### Security Levels\n\n| Level | Description |\n|-------|-------------|\n| Privileged | Unrestricted, for system workloads |\n| Baseline | Prevents known privilege escalations |\n| Restricted | Hardened, best practices |\n\n### Enforcement Modes\n\n```yaml\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: my-namespace\n  labels:\n    pod-security.kubernetes.io/enforce: restricted\n    pod-security.kubernetes.io/warn: restricted\n    pod-security.kubernetes.io/audit: restricted\n```\n\n## Security Context\n\nConfigure security settings at pod/container level.\n\n```yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: secure-pod\nspec:\n  securityContext:\n    runAsNonRoot: true\n    runAsUser: 1000\n    fsGroup: 2000\n    seccompProfile:\n      type: RuntimeDefault\n  containers:\n  - name: app\n    image: myapp:latest\n    securityContext:\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n      capabilities:\n        drop: ["ALL"]\n```\n\n## Key Restrictions\n\n### Restricted Level Requirements\n- Must run as non-root\n- Must drop all capabilities\n- No privilege escalation\n- No hostPath volumes\n- No hostNetwork/hostPID/hostIPC\n\n## Best Practices\n\n1. Start with **Restricted** level\n2. Use **RuntimeDefault** seccomp profile\n3. Always set **readOnlyRootFilesystem**\n4. Drop **ALL** capabilities\n5. Run as **non-root** user', 3, 15),

('28db418e-6fd1-44de-b3af-56468236723f', 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8091', 'Network Policies', E'# Network Policies\n\n## Default Kubernetes Networking\n\nBy default, all pods can communicate with all other pods - this is **dangerous**!\n\n## Network Policy Basics\n\nNetwork policies are namespace-scoped firewall rules.\n\n```yaml\napiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: api-allow\n  namespace: production\nspec:\n  podSelector:\n    matchLabels:\n      app: api\n  policyTypes:\n  - Ingress\n  - Egress\n  ingress:\n  - from:\n    - podSelector:\n        matchLabels:\n          app: frontend\n    ports:\n    - protocol: TCP\n      port: 8080\n  egress:\n  - to:\n    - podSelector:\n        matchLabels:\n          app: database\n    ports:\n    - protocol: TCP\n      port: 5432\n```\n\n## Policy Types\n\n### Default Deny All\n\n```yaml\napiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: default-deny-all\nspec:\n  podSelector: {}\n  policyTypes:\n  - Ingress\n  - Egress\n```\n\n### Allow DNS Egress\n\n```yaml\negress:\n- to:\n  - namespaceSelector: {}\n    podSelector:\n      matchLabels:\n        k8s-app: kube-dns\n  ports:\n  - protocol: UDP\n    port: 53\n```\n\n## CNI Requirements\n\nNetwork policies require a CNI that supports them:\n- Calico ✓\n- Cilium ✓\n- Weave Net ✓\n- Flannel ✗\n\n## Best Practices\n\n1. Start with **default deny**\n2. Allow only **required** traffic\n3. Use **namespace selectors** for isolation\n4. Always allow **DNS** egress\n5. Test policies in **non-production** first', 4, 15),

('622097a9-c493-42f8-a358-3b9a165f600d', 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8091', 'Secrets Management', E'# Secrets Management\n\n## Kubernetes Secrets\n\nNative way to store sensitive data in Kubernetes.\n\n### Creating Secrets\n\n```yaml\napiVersion: v1\nkind: Secret\nmetadata:\n  name: db-credentials\ntype: Opaque\nstringData:\n  username: admin\n  password: supersecret\n```\n\n### Limitations of K8s Secrets\n- Base64 encoded, not encrypted\n- Stored in etcd (encrypt at rest!)\n- Visible in pod spec\n- No automatic rotation\n\n## Encrypting Secrets at Rest\n\n```yaml\napiVersion: apiserver.config.k8s.io/v1\nkind: EncryptionConfiguration\nresources:\n  - resources:\n      - secrets\n    providers:\n      - aescbc:\n          keys:\n            - name: key1\n              secret: <base64-encoded-key>\n      - identity: {}\n```\n\n## External Secret Managers\n\n### Popular Solutions\n\n| Solution | Provider | Features |\n|----------|----------|-----------|\n| HashiCorp Vault | Any | Full-featured |\n| AWS Secrets Manager | AWS | Native integration |\n| Azure Key Vault | Azure | Managed HSM |\n| GCP Secret Manager | GCP | IAM integration |\n\n### External Secrets Operator\n\n```yaml\napiVersion: external-secrets.io/v1beta1\nkind: ExternalSecret\nmetadata:\n  name: db-secret\nspec:\n  refreshInterval: 1h\n  secretStoreRef:\n    name: vault-backend\n    kind: SecretStore\n  target:\n    name: db-credentials\n  data:\n  - secretKey: password\n    remoteRef:\n      key: database/prod\n      property: password\n```\n\n## Best Practices\n\n1. **Never** commit secrets to git\n2. Enable **encryption at rest**\n3. Use **external secret managers**\n4. Implement **secret rotation**\n5. Audit **secret access**', 5, 15),

('8c86a1d2-cd1e-4688-89f7-88115a7c95c2', 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8091', 'Runtime Security and Monitoring', E'# Runtime Security and Monitoring\n\n## Runtime Threats\n\n| Threat | Description | Detection |\n|--------|-------------|----------|\n| Container escape | Breaking out of container | Syscall monitoring |\n| Cryptomining | Unauthorized resource use | CPU anomalies |\n| Reverse shells | Remote access | Network monitoring |\n| Data exfiltration | Stealing data | Egress monitoring |\n\n## Falco - Runtime Security\n\nOpen-source runtime security tool using eBPF.\n\n### Example Rules\n\n```yaml\n- rule: Terminal shell in container\n  desc: Detect shell in container\n  condition: >\n    spawned_process and\n    container and\n    shell_procs\n  output: >\n    Shell spawned in container\n    (user=%user.name container=%container.name)\n  priority: WARNING\n```\n\n## Container Image Security\n\n### Image Scanning\n\n```bash\n# Trivy scanner\ntrivy image myapp:latest\n\n# Scan for vulnerabilities\ntrivy image --severity HIGH,CRITICAL myapp:latest\n```\n\n### Signing Images\n\n```bash\n# Using cosign\ncosign sign --key cosign.key myregistry/myapp:latest\n\n# Verify signature\ncosign verify --key cosign.pub myregistry/myapp:latest\n```\n\n## Audit Logging\n\nEnable Kubernetes audit logging:\n\n```yaml\napiVersion: audit.k8s.io/v1\nkind: Policy\nrules:\n- level: Metadata\n  resources:\n  - group: ""\n    resources: ["secrets"]\n```\n\n## Observability Stack\n\n### Recommended Tools\n- **Prometheus**: Metrics collection\n- **Grafana**: Visualization\n- **Loki**: Log aggregation\n- **Jaeger**: Distributed tracing\n\n## Best Practices\n\n1. Deploy **Falco** for runtime detection\n2. Scan images in **CI/CD pipeline**\n3. Sign and verify **container images**\n4. Enable **audit logging**\n5. Monitor for **anomalous behavior**', 6, 15);

-- =============================================
-- LESSONS - Zero Trust Architecture
-- =============================================
INSERT INTO lessons (id, course_id, title, content, order_index, duration_minutes) VALUES
('c12e68b5-05dc-4a17-930d-79ce4c0e9725', 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f809102', 'Zero Trust Principles', E'# Zero Trust Principles\n\n## What is Zero Trust?\n\nZero Trust is a security model based on the principle: **"Never trust, always verify."**\n\n### Traditional vs Zero Trust\n\n| Traditional | Zero Trust |\n|-------------|------------|\n| Trust internal network | Trust nothing |\n| Perimeter-based | Identity-based |\n| Static access | Continuous verification |\n| Implicit trust | Explicit verification |\n\n## Core Principles\n\n### 1. Verify Explicitly\nAlways authenticate and authorize based on all available data points:\n- User identity\n- Device health\n- Location\n- Service/workload\n- Data classification\n\n### 2. Least Privilege Access\nLimit user access with:\n- Just-in-time (JIT) access\n- Just-enough-access (JEA)\n- Risk-based adaptive policies\n\n### 3. Assume Breach\nMinimize blast radius and segment access:\n- Micro-segmentation\n- End-to-end encryption\n- Continuous monitoring\n\n## Zero Trust Architecture\n\n```\n┌────────────────────────────────────────┐\n│           Policy Engine                 │\n│  ┌──────────┐  ┌──────────────────┐    │\n│  │ Identity │  │ Device Posture   │    │\n│  └──────────┘  └──────────────────┘    │\n│  ┌──────────┐  ┌──────────────────┐    │\n│  │ Context  │  │ Threat Intel     │    │\n│  └──────────┘  └──────────────────┘    │\n└────────────────────────────────────────┘\n              │\n              ▼\n┌────────────────────────────────────────┐\n│         Policy Enforcement              │\n│    (Access Proxy / Gateway)             │\n└────────────────────────────────────────┘\n              │\n              ▼\n┌────────────────────────────────────────┐\n│         Protected Resources             │\n└────────────────────────────────────────┘\n```\n\n## Benefits\n\n1. Reduced attack surface\n2. Better visibility\n3. Improved compliance\n4. Cloud-ready security', 1, 15),

('76d28b1b-8e70-46cc-bc10-13c055e59073', 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f809102', 'Identity-Centric Security', E'# Identity-Centric Security\n\n## Identity as the New Perimeter\n\nIn zero trust, identity replaces network location as the primary security boundary.\n\n## Identity Components\n\n### User Identity\n- Username/password\n- Multi-factor authentication\n- Biometrics\n- Passwordless authentication\n\n### Device Identity\n- Device certificates\n- Hardware attestation\n- Endpoint posture\n\n### Workload Identity\n- Service accounts\n- Machine identities\n- API keys\n\n## Multi-Factor Authentication (MFA)\n\n### MFA Factors\n\n| Factor | Type | Example |\n|--------|------|---------|\n| Something you know | Knowledge | Password, PIN |\n| Something you have | Possession | Phone, security key |\n| Something you are | Inherence | Fingerprint, face |\n\n### Phishing-Resistant MFA\n- FIDO2/WebAuthn\n- Hardware security keys\n- Platform authenticators\n\n## Identity Providers\n\n### Modern IdP Features\n- Single Sign-On (SSO)\n- Conditional access policies\n- Risk-based authentication\n- Session management\n\n### Federation Protocols\n- SAML 2.0\n- OpenID Connect\n- OAuth 2.0\n\n## Identity Governance\n\n### Lifecycle Management\n1. **Joiner**: Provision access\n2. **Mover**: Adjust permissions\n3. **Leaver**: Revoke access\n\n### Access Reviews\n- Regular certification campaigns\n- Manager attestation\n- Automated deprovisioning\n\n## Best Practices\n\n1. Implement **passwordless** authentication\n2. Require **phishing-resistant MFA**\n3. Use **conditional access** policies\n4. Enable **identity threat detection**\n5. Automate **lifecycle management**', 2, 15),

('7598180a-f819-4edd-ae3f-f1eaa0cf40d5', 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f809102', 'Micro-Segmentation', E'# Micro-Segmentation\n\n## What is Micro-Segmentation?\n\nMicro-segmentation divides the network into small, isolated segments with individual security controls.\n\n## Traditional vs Micro-Segmentation\n\n### Traditional Network Segmentation\n```\n┌─────────────────────────────────────┐\n│              DMZ                     │\n├─────────────────────────────────────┤\n│          Web Tier                    │\n├─────────────────────────────────────┤\n│          App Tier                    │\n├─────────────────────────────────────┤\n│          Data Tier                   │\n└─────────────────────────────────────┘\n```\n\n### Micro-Segmentation\n```\n┌─────┐  ┌─────┐  ┌─────┐  ┌─────┐\n│ Web │  │ API │  │ App │  │ DB  │\n│  1  │  │  1  │  │  1  │  │  1  │\n└──┬──┘  └──┬──┘  └──┬──┘  └──┬──┘\n   │        │        │        │\n   └────────┴────────┴────────┘\n   (Only allowed connections)\n```\n\n## Implementation Approaches\n\n### 1. Agent-Based\n- Software agents on endpoints\n- Application-aware policies\n- Examples: Illumio, Guardicore\n\n### 2. Network-Based\n- SDN controllers\n- Virtual firewalls\n- Examples: VMware NSX, Cisco ACI\n\n### 3. Cloud-Native\n- Security groups\n- Network policies (K8s)\n- Service mesh (Istio)\n\n## Policy Definition\n\n### Identity-Based Policies\n```yaml\npolicy:\n  name: api-to-database\n  source:\n    labels:\n      app: api-server\n  destination:\n    labels:\n      app: postgres\n  ports:\n    - 5432\n  action: allow\n```\n\n## Benefits\n\n1. **Reduced blast radius**: Contain breaches\n2. **Visibility**: See all traffic flows\n3. **Compliance**: Isolate sensitive data\n4. **Flexibility**: Policy follows workload\n\n## Best Practices\n\n1. Start with **visibility** mode\n2. Build **application dependency maps**\n3. Define policies by **identity**, not IP\n4. Use **deny-by-default** stance\n5. Monitor and **alert** on policy violations', 3, 15),

('6fa1c4c6-3a5a-4531-bda0-3f73b1d29c24', 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f809102', 'Continuous Verification', E'# Continuous Verification\n\n## Beyond Point-in-Time Authentication\n\nTraditional security authenticates once at login. Zero Trust requires **continuous verification** throughout the session.\n\n## What to Verify\n\n### User Context\n- Authentication state\n- Session age\n- Behavioral patterns\n- Risk score\n\n### Device Context\n- Compliance status\n- Patch level\n- Security software\n- Encryption status\n\n### Network Context\n- Location/IP\n- Network type\n- Time of access\n- Connection method\n\n### Resource Context\n- Data sensitivity\n- Access patterns\n- Anomaly detection\n\n## Risk-Based Access Decisions\n\n### Risk Score Calculation\n\n```\nRisk Score = f(User Risk + Device Risk + \n              Network Risk + Behavior Risk)\n\nIf Risk Score > Threshold:\n    → Require step-up authentication\n    → Block access\n    → Alert security team\n```\n\n### Adaptive Response\n\n| Risk Level | Response |\n|------------|----------|\n| Low | Allow access |\n| Medium | Require MFA |\n| High | Block + alert |\n| Critical | Terminate session |\n\n## Session Management\n\n### Continuous Session Evaluation\n1. Short-lived tokens (15 min - 1 hour)\n2. Refresh with re-evaluation\n3. Automatic termination on risk change\n\n### Just-in-Time Access\n- Request access when needed\n- Time-limited grants\n- Automatic revocation\n- Approval workflows\n\n## Implementation Technologies\n\n- **UEBA**: User Entity Behavior Analytics\n- **CASB**: Cloud Access Security Broker\n- **SASE**: Secure Access Service Edge\n- **XDR**: Extended Detection and Response\n\n## Best Practices\n\n1. Implement **real-time** risk assessment\n2. Use **short-lived** access tokens\n3. Enable **anomaly detection**\n4. Require **step-up auth** for sensitive actions\n5. Log and audit **all** access decisions', 4, 15),

('91e8f916-467a-431e-998f-70968aabfa33', 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f809102', 'Implementing Zero Trust in Cloud', E'# Implementing Zero Trust in Cloud\n\n## Cloud Zero Trust Architecture\n\n### Components\n\n1. **Identity Provider**: Central authentication\n2. **Access Proxy**: Policy enforcement point\n3. **Policy Engine**: Decision making\n4. **Workload Security**: Container/VM protection\n\n## AWS Zero Trust Implementation\n\n### Key Services\n- **AWS IAM Identity Center**: SSO and identity\n- **AWS Verified Access**: Application access\n- **AWS PrivateLink**: Private connectivity\n- **AWS Network Firewall**: Traffic inspection\n\n### Example Architecture\n```\nUser → Identity Center → Verified Access → \nPrivate VPC → Application\n```\n\n## Azure Zero Trust Implementation\n\n### Key Services\n- **Azure AD**: Identity platform\n- **Conditional Access**: Policy enforcement\n- **Azure Private Link**: Private endpoints\n- **Azure Firewall**: Network security\n\n### Conditional Access Policy\n```json\n{\n  "conditions": {\n    "users": ["All Users"],\n    "applications": ["Sensitive App"],\n    "devicePlatforms": ["all"]\n  },\n  "grantControls": {\n    "operator": "AND",\n    "builtInControls": [\n      "mfa",\n      "compliantDevice"\n    ]\n  }\n}\n```\n\n## GCP Zero Trust Implementation\n\n### Key Services\n- **BeyondCorp Enterprise**: Zero trust platform\n- **Cloud IAP**: Identity-Aware Proxy\n- **VPC Service Controls**: Data protection\n- **Cloud Armor**: DDoS and WAF\n\n## Implementation Roadmap\n\n### Phase 1: Foundation\n- Deploy identity provider\n- Enable MFA everywhere\n- Inventory all assets\n\n### Phase 2: Access Control\n- Implement access proxy\n- Define policies\n- Start micro-segmentation\n\n### Phase 3: Continuous\n- Enable analytics\n- Implement automation\n- Continuous improvement\n\n## Best Practices\n\n1. Start with **identity** foundation\n2. Protect **crown jewels** first\n3. Implement in **phases**\n4. Use **cloud-native** services\n5. Measure and **iterate**', 5, 15);

-- =============================================
-- LESSONS - Cloud Compliance & Governance
-- =============================================
INSERT INTO lessons (id, course_id, title, content, order_index, duration_minutes) VALUES
('9783cdac-99f4-4177-a584-b332f5383b94', 'a7b8c9d0-e1f2-4a3b-4c5d-6e7f80910213', 'Cloud Compliance Overview', E'# Cloud Compliance Overview\n\n## Why Cloud Compliance Matters\n\nCloud compliance ensures your organization meets regulatory, legal, and industry requirements while operating in the cloud.\n\n## Shared Responsibility Model\n\n| Layer | Provider | Customer |\n|-------|----------|----------|\n| Physical security | ✓ | |\n| Network infrastructure | ✓ | |\n| Hypervisor | ✓ | |\n| Operating system | Depends | Depends |\n| Applications | | ✓ |\n| Data | | ✓ |\n| Access management | | ✓ |\n\n## Major Compliance Frameworks\n\n### Regional Regulations\n- **GDPR** (EU) - Data privacy\n- **CCPA** (California) - Consumer privacy\n- **PIPEDA** (Canada) - Personal information\n\n### Industry Standards\n- **PCI DSS** - Payment card data\n- **HIPAA** - Healthcare (US)\n- **SOC 2** - Service organizations\n- **ISO 27001** - Information security\n\n### Government\n- **FedRAMP** (US Government)\n- **NIST** (US Standards)\n- **CSA STAR** (Cloud security)\n\n## Compliance Challenges in Cloud\n\n1. **Data location**: Where is data stored?\n2. **Access control**: Who can access what?\n3. **Audit trails**: Can you prove compliance?\n4. **Vendor management**: Are vendors compliant?\n5. **Dynamic resources**: Ephemeral infrastructure\n\n## Key Compliance Activities\n\n1. **Assess**: Understand requirements\n2. **Implement**: Deploy controls\n3. **Monitor**: Continuous compliance\n4. **Report**: Generate evidence\n5. **Remediate**: Fix gaps\n\n## Best Practices\n\n1. Know your **regulatory landscape**\n2. Use **compliance automation** tools\n3. Implement **continuous monitoring**\n4. Maintain **comprehensive documentation**\n5. Conduct regular **audits**', 1, 12),

('49dd1eee-61e1-4652-9215-a970c46c2402', 'a7b8c9d0-e1f2-4a3b-4c5d-6e7f80910213', 'GDPR and Data Privacy', E'# GDPR and Data Privacy\n\n## General Data Protection Regulation (GDPR)\n\nEU regulation protecting personal data of EU residents, applicable to any organization processing their data.\n\n## Key Concepts\n\n### Personal Data\nAny information relating to an identified or identifiable person:\n- Name, email, phone\n- IP address\n- Location data\n- Online identifiers\n\n### Special Category Data\nSensitive data requiring extra protection:\n- Health data\n- Biometric data\n- Racial/ethnic origin\n- Political opinions\n\n## GDPR Principles\n\n| Principle | Requirement |\n|-----------|--------------|\n| Lawfulness | Legal basis for processing |\n| Purpose limitation | Specific, legitimate purposes |\n| Data minimization | Only necessary data |\n| Accuracy | Keep data up to date |\n| Storage limitation | Delete when no longer needed |\n| Security | Appropriate protection |\n| Accountability | Demonstrate compliance |\n\n## Data Subject Rights\n\n1. **Right to access**: See their data\n2. **Right to rectification**: Correct errors\n3. **Right to erasure**: "Right to be forgotten"\n4. **Right to portability**: Transfer data\n5. **Right to object**: Stop processing\n6. **Right to restrict**: Limit processing\n\n## Cloud GDPR Implementation\n\n### Data Mapping\n```yaml\nPersonal Data Inventory:\n  - System: CRM\n    Data Types: [name, email, phone]\n    Location: EU-West-1\n    Retention: 3 years\n    Legal Basis: Contract\n```\n\n### Technical Measures\n- Encryption at rest and in transit\n- Pseudonymization\n- Access controls\n- Audit logging\n- Data loss prevention\n\n### Breach Notification\n- 72-hour notification to authority\n- Communication to affected individuals\n- Documentation of all breaches\n\n## Best Practices\n\n1. Conduct **Data Protection Impact Assessments**\n2. Implement **Privacy by Design**\n3. Maintain **processing records**\n4. Enable **data subject request** workflows\n5. Encrypt **all personal data**', 2, 14),

('6f236d1b-04f3-42b2-9219-18e191010279', 'a7b8c9d0-e1f2-4a3b-4c5d-6e7f80910213', 'SOC 2 Requirements', E'# SOC 2 Requirements\n\n## What is SOC 2?\n\nSOC 2 is an auditing standard for service organizations, based on Trust Services Criteria.\n\n## Trust Services Criteria (TSC)\n\n### Security (Required)\nProtection against unauthorized access.\n\n**Common Controls:**\n- Firewalls and network security\n- Access controls\n- Encryption\n- Monitoring and logging\n\n### Availability\nSystem availability for operation and use.\n\n**Common Controls:**\n- Disaster recovery\n- Backup procedures\n- Capacity planning\n- Incident management\n\n### Processing Integrity\nSystem processing is complete, valid, and timely.\n\n**Common Controls:**\n- Quality assurance\n- Error handling\n- Data validation\n- Processing monitoring\n\n### Confidentiality\nInformation designated as confidential is protected.\n\n**Common Controls:**\n- Data classification\n- Encryption\n- Access restrictions\n- Secure disposal\n\n### Privacy\nPersonal information handling meets privacy notice.\n\n**Common Controls:**\n- Privacy policy\n- Consent management\n- Data subject rights\n- Third-party management\n\n## SOC 2 Report Types\n\n| Type | Coverage | Use Case |\n|------|----------|----------|\n| Type I | Point in time | Initial assessment |\n| Type II | 6-12 month period | Ongoing assurance |\n\n## Cloud SOC 2 Controls\n\n### Access Control\n```\n- Multi-factor authentication\n- Role-based access control\n- Regular access reviews\n- Privileged access management\n```\n\n### Change Management\n```\n- Change approval process\n- Testing before deployment\n- Rollback procedures\n- Change documentation\n```\n\n### Monitoring\n```\n- Security event logging\n- Intrusion detection\n- Vulnerability scanning\n- Performance monitoring\n```\n\n## Best Practices\n\n1. Start with **gap assessment**\n2. Implement **continuous controls**\n3. Automate **evidence collection**\n4. Use **GRC platforms**\n5. Prepare for **annual audits**', 3, 14),

('44d6c6e5-b0ab-4edc-be92-8260704352b3', 'a7b8c9d0-e1f2-4a3b-4c5d-6e7f80910213', 'ISO 27001 in Cloud', E'# ISO 27001 in Cloud\n\n## What is ISO 27001?\n\nInternational standard for Information Security Management Systems (ISMS).\n\n## ISMS Framework\n\n### Plan-Do-Check-Act Cycle\n\n```\n    ┌─────────────┐\n    │    PLAN     │\n    │ Establish   │\n    │   ISMS      │\n    └──────┬──────┘\n           │\n┌──────────┼──────────┐\n│          ▼          │\n│    ┌──────────┐     │\n│ ACT│          │DO   │\n│    │  ISMS    │     │\n│    │          │     │\n│    └──────────┘     │\n│          ▲          │\n└──────────┼──────────┘\n           │\n    ┌──────┴──────┐\n    │   CHECK     │\n    │  Monitor    │\n    └─────────────┘\n```\n\n## Annex A Controls\n\n### Organizational Controls (A.5)\n- Information security policies\n- Organization of information security\n- Human resource security\n- Asset management\n\n### Physical Controls (A.7)\n- Secure areas\n- Equipment security\n\n### Technological Controls (A.8)\n- Access control\n- Cryptography\n- Operations security\n- Communications security\n\n## Cloud-Specific Considerations\n\n### Clause 4: Context\n- Cloud service dependencies\n- Shared responsibility\n- Regulatory requirements\n\n### Clause 6: Risk Assessment\n```yaml\nRisk Assessment:\n  Asset: Customer Database\n  Threat: Data breach\n  Vulnerability: Misconfigured storage\n  Likelihood: Medium\n  Impact: High\n  Risk Level: High\n  Treatment: Encryption, access controls\n```\n\n### Clause 8: Operations\n- Cloud security controls\n- Vendor management\n- Incident response\n\n## Documentation Requirements\n\n1. **ISMS scope**\n2. **Information security policy**\n3. **Risk assessment methodology**\n4. **Statement of Applicability**\n5. **Risk treatment plan**\n\n## Certification Process\n\n1. Gap analysis\n2. ISMS implementation\n3. Internal audit\n4. Stage 1 audit (documentation)\n5. Stage 2 audit (implementation)\n6. Certification\n7. Surveillance audits\n\n## Best Practices\n\n1. Align with **business objectives**\n2. Get **management commitment**\n3. Use **risk-based approach**\n4. Implement **continuous improvement**\n5. Integrate with **other standards**', 4, 14),

('e518f0a9-2d10-4bfe-a85c-f01bfbdfc771', 'a7b8c9d0-e1f2-4a3b-4c5d-6e7f80910213', 'PCI DSS for Cloud', E'# PCI DSS for Cloud\n\n## What is PCI DSS?\n\nPayment Card Industry Data Security Standard - requirements for handling cardholder data.\n\n## Cardholder Data\n\n### Primary Account Number (PAN)\nThe credit card number - must be protected.\n\n### Sensitive Authentication Data\n- Full magnetic stripe\n- CVV/CVC\n- PIN\n- **Never store after authorization!**\n\n## PCI DSS Requirements\n\n### Build and Maintain Secure Network\n1. Install and maintain firewall\n2. Change vendor defaults\n\n### Protect Cardholder Data\n3. Protect stored cardholder data\n4. Encrypt transmission\n\n### Maintain Vulnerability Management\n5. Use anti-malware software\n6. Develop secure systems\n\n### Implement Strong Access Control\n7. Restrict access by business need\n8. Identify and authenticate users\n9. Restrict physical access\n\n### Monitor and Test Networks\n10. Track and monitor access\n11. Regular security testing\n\n### Maintain Security Policy\n12. Information security policy\n\n## Cloud PCI Compliance\n\n### Shared Responsibility\n\n| Requirement | IaaS | PaaS | SaaS |\n|-------------|------|------|------|\n| Network | Shared | Provider | Provider |\n| OS | Customer | Provider | Provider |\n| Application | Customer | Customer | Provider |\n| Data | Customer | Customer | Shared |\n\n### Scope Reduction Strategies\n\n1. **Tokenization**: Replace PAN with token\n2. **P2PE**: Point-to-point encryption\n3. **Outsourcing**: Use compliant providers\n4. **Segmentation**: Isolate CDE\n\n## Cloud Controls\n\n### Network Segmentation\n```\n┌─────────────────────────────────┐\n│         Non-CDE                 │\n├─────────────────────────────────┤\n│  [Firewall/Security Group]      │\n├─────────────────────────────────┤\n│    Cardholder Data Env (CDE)    │\n│  ┌─────┐  ┌─────┐  ┌─────┐     │\n│  │ Web │  │ App │  │ DB  │     │\n│  └─────┘  └─────┘  └─────┘     │\n└─────────────────────────────────┘\n```\n\n### Encryption Requirements\n- TLS 1.2+ for transmission\n- AES-256 for storage\n- Secure key management\n\n## Best Practices\n\n1. **Minimize** cardholder data storage\n2. Use **tokenization** where possible\n3. Implement **network segmentation**\n4. Choose **PCI-compliant** providers\n5. Document **responsibility matrix**', 5, 14),

('d8fea539-dd2d-40ea-8c06-e0a7cef4bb40', 'a7b8c9d0-e1f2-4a3b-4c5d-6e7f80910213', 'Building a Compliance Program', E'# Building a Compliance Program\n\n## Compliance Program Framework\n\n### Governance Structure\n\n```\n┌─────────────────────────────────┐\n│     Executive Sponsorship        │\n├─────────────────────────────────┤\n│     Compliance Committee         │\n├─────────────────────────────────┤\n│   ┌─────────┬─────────┬──────┐  │\n│   │   IT    │  Legal  │ Risk │  │\n│   │Security │         │      │  │\n│   └─────────┴─────────┴──────┘  │\n└─────────────────────────────────┘\n```\n\n## Program Components\n\n### 1. Policy Framework\n- Information security policy\n- Acceptable use policy\n- Data classification policy\n- Incident response policy\n- Vendor management policy\n\n### 2. Risk Management\n```yaml\nRisk Register:\n  - Risk: Data breach\n    Owner: CISO\n    Likelihood: Medium\n    Impact: High\n    Controls: Encryption, DLP, Monitoring\n    Residual Risk: Low\n```\n\n### 3. Control Framework\nMap controls to requirements:\n- NIST CSF\n- CIS Controls\n- Cloud provider controls\n\n### 4. Monitoring and Metrics\n\n| Metric | Target | Frequency |\n|--------|--------|-----------|\n| Vulnerability remediation | <30 days | Weekly |\n| Access review completion | 100% | Quarterly |\n| Training completion | 100% | Annual |\n| Audit findings closed | 90% | Monthly |\n\n## Automation Tools\n\n### Compliance as Code\n```python\n# Example: Check S3 bucket encryption\ndef check_s3_encryption(bucket):\n    encryption = s3.get_bucket_encryption(\n        Bucket=bucket\n    )\n    return encryption is not None\n```\n\n### Cloud-Native Tools\n- AWS Config + Security Hub\n- Azure Policy + Defender\n- GCP Security Command Center\n\n### Third-Party Tools\n- Prisma Cloud\n- Lacework\n- Orca Security\n\n## Evidence Collection\n\n### Automated Evidence\n- Configuration snapshots\n- Audit logs\n- Compliance reports\n- Scan results\n\n### Manual Evidence\n- Policy documents\n- Training records\n- Meeting minutes\n- Attestations\n\n## Continuous Compliance\n\n1. **Real-time monitoring**: Detect drift\n2. **Automated remediation**: Fix issues\n3. **Dashboard reporting**: Visibility\n4. **Regular assessments**: Validate controls\n5. **Continuous improvement**: Learn and adapt\n\n## Best Practices\n\n1. Get **executive buy-in**\n2. Adopt **compliance automation**\n3. Integrate with **DevOps** (DevSecOps)\n4. Maintain **living documentation**\n5. Foster **security culture**', 6, 12);

-- =============================================
-- LESSONS - AWS Advanced Security
-- =============================================
INSERT INTO lessons (id, course_id, title, content, order_index, duration_minutes) VALUES
('634e372f-56c5-4dad-b29b-a2bade664a41', 'b8c9d0e1-f2a3-4b4c-5d6e-7f8091021324', 'AWS Organizations and SCPs', E'# AWS Organizations and SCPs\n\n## AWS Organizations\n\nCentrally manage multiple AWS accounts from a single location.\n\n### Organization Structure\n\n```\nRoot\n├── Production OU\n│   ├── Account: prod-app-1\n│   └── Account: prod-app-2\n├── Development OU\n│   ├── Account: dev-team-1\n│   └── Account: dev-team-2\n└── Security OU\n    └── Account: security-audit\n```\n\n## Service Control Policies (SCPs)\n\nSCPs set permission guardrails for accounts in your organization.\n\n### SCP Inheritance\n\n```\nRoot (SCP: DenyExpensiveRegions)\n└── Production OU (SCP: RequireEncryption)\n    └── Account (Effective: Both SCPs apply)\n```\n\n### Example SCPs\n\n#### Deny Regions\n```json\n{\n  "Version": "2012-10-17",\n  "Statement": [{\n    "Sid": "DenyNonApprovedRegions",\n    "Effect": "Deny",\n    "Action": "*",\n    "Resource": "*",\n    "Condition": {\n      "StringNotEquals": {\n        "aws:RequestedRegion": [\n          "us-east-1",\n          "us-west-2"\n        ]\n      }\n    }\n  }]\n}\n```\n\n#### Require Encryption\n```json\n{\n  "Version": "2012-10-17",\n  "Statement": [{\n    "Sid": "DenyUnencryptedS3",\n    "Effect": "Deny",\n    "Action": "s3:PutObject",\n    "Resource": "*",\n    "Condition": {\n      "Null": {\n        "s3:x-amz-server-side-encryption": "true"\n      }\n    }\n  }]\n}\n```\n\n## OU Design Patterns\n\n### Security OU\n- Log archive account\n- Security tooling account\n- Audit account\n\n### Workload OUs\n- Production\n- Development\n- Staging\n\n### Sandbox OU\n- Developer experimentation\n- Restricted SCPs\n\n## Best Practices\n\n1. Use **dedicated security OU**\n2. Apply **preventive SCPs**\n3. Implement **account vending**\n4. Enable **CloudTrail** organization trail\n5. Centralize **security services**', 1, 14),

('3d4b3bf4-2637-4ad1-ad05-2e609ed9162c', 'b8c9d0e1-f2a3-4b4c-5d6e-7f8091021324', 'Advanced IAM Patterns', E'# Advanced IAM Patterns\n\n## Permission Boundaries\n\nSet maximum permissions for IAM entities.\n\n### Use Case: Developer Self-Service\n\n```json\n{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Action": [\n        "lambda:*",\n        "dynamodb:*"\n      ],\n      "Resource": "*"\n    },\n    {\n      "Effect": "Deny",\n      "Action": [\n        "iam:*",\n        "organizations:*"\n      ],\n      "Resource": "*"\n    }\n  ]\n}\n```\n\n## Session Policies\n\nFurther restrict role permissions for specific sessions.\n\n```python\nsts.assume_role(\n    RoleArn="arn:aws:iam::123456789:role/DataAccess",\n    RoleSessionName="limited-session",\n    Policy=json.dumps({\n        "Version": "2012-10-17",\n        "Statement": [{\n            "Effect": "Allow",\n            "Action": "s3:GetObject",\n            "Resource": "arn:aws:s3:::bucket/path/*"\n        }]\n    })\n)\n```\n\n## Attribute-Based Access Control (ABAC)\n\nUse tags for dynamic access control.\n\n```json\n{\n  "Version": "2012-10-17",\n  "Statement": [{\n    "Effect": "Allow",\n    "Action": "ec2:*",\n    "Resource": "*",\n    "Condition": {\n      "StringEquals": {\n        "aws:ResourceTag/Project": "${aws:PrincipalTag/Project}"\n      }\n    }\n  }]\n}\n```\n\n## Cross-Account Access\n\n### Resource-Based Policies\n```json\n{\n  "Effect": "Allow",\n  "Principal": {\n    "AWS": "arn:aws:iam::OTHER_ACCOUNT:role/CrossRole"\n  },\n  "Action": "s3:GetObject",\n  "Resource": "arn:aws:s3:::bucket/*"\n}\n```\n\n### Assume Role\n```json\n{\n  "Effect": "Allow",\n  "Principal": {\n    "AWS": "arn:aws:iam::OTHER_ACCOUNT:root"\n  },\n  "Action": "sts:AssumeRole"\n}\n```\n\n## IAM Access Analyzer\n\nFind unintended access:\n- External principals\n- Public resources\n- Cross-account access\n- Policy validation\n\n## Best Practices\n\n1. Use **permission boundaries** for delegation\n2. Implement **ABAC** for scalability\n3. Prefer **roles** over users\n4. Use **Access Analyzer** regularly\n5. Enable **credential reports**', 2, 14),

('b2aec30b-6eee-4159-b898-02cd6ec16f23', 'b8c9d0e1-f2a3-4b4c-5d6e-7f8091021324', 'GuardDuty and Security Hub', E'# GuardDuty and Security Hub\n\n## Amazon GuardDuty\n\nIntelligent threat detection service using ML.\n\n### Data Sources\n- VPC Flow Logs\n- CloudTrail Events\n- DNS Logs\n- S3 Data Events\n- EKS Audit Logs\n\n### Finding Types\n\n| Category | Examples |\n|----------|----------|\n| Reconnaissance | Port scan, unusual API |\n| Instance Compromise | Crypto mining, malware |\n| Account Compromise | Anomalous behavior |\n| Bucket Compromise | S3 public access |\n\n### Example Finding\n```json\n{\n  "Type": "UnauthorizedAccess:EC2/SSHBruteForce",\n  "Severity": 2,\n  "Resource": {\n    "InstanceDetails": {\n      "InstanceId": "i-1234567890"\n    }\n  },\n  "Service": {\n    "Action": {\n      "NetworkConnectionAction": {\n        "RemoteIpDetails": {\n          "IpAddressV4": "1.2.3.4"\n        }\n      }\n    }\n  }\n}\n```\n\n## AWS Security Hub\n\nCentralized security posture management.\n\n### Features\n- Aggregates findings from multiple services\n- Compliance checks against standards\n- Automated remediation\n\n### Supported Standards\n- AWS Foundational Security Best Practices\n- CIS AWS Foundations Benchmark\n- PCI DSS\n- NIST 800-53\n\n### Finding Format (ASFF)\n```json\n{\n  "SchemaVersion": "2018-10-08",\n  "ProductArn": "arn:aws:securityhub:...",\n  "GeneratorId": "aws-foundational-security",\n  "Title": "S3.1 Block public access",\n  "Severity": {"Label": "CRITICAL"},\n  "Compliance": {"Status": "FAILED"}\n}\n```\n\n## Integration Architecture\n\n```\n┌─────────┐ ┌─────────┐ ┌──────────┐\n│GuardDuty│ │Inspector│ │  Macie   │\n└────┬────┘ └────┬────┘ └────┬─────┘\n     │           │           │\n     └───────────┼───────────┘\n                 ▼\n          ┌─────────────┐\n          │Security Hub │\n          └──────┬──────┘\n                 │\n     ┌───────────┼───────────┐\n     ▼           ▼           ▼\n┌────────┐ ┌─────────┐ ┌─────────┐\n│EventBridge│ │ SIEM  │ │Ticketing│\n└────────┘ └─────────┘ └─────────┘\n```\n\n## Best Practices\n\n1. Enable **GuardDuty** in all accounts/regions\n2. Use **delegated administrator**\n3. Configure **auto-remediation**\n4. Export to **SIEM**\n5. Review findings **daily**', 3, 14),

('3c1ca8a6-cc6c-400b-a08a-185f82b9361a', 'b8c9d0e1-f2a3-4b4c-5d6e-7f8091021324', 'WAF and Shield', E'# WAF and Shield\n\n## AWS WAF\n\nWeb Application Firewall for HTTP/HTTPS protection.\n\n### WAF Components\n\n```\nWeb ACL\n├── Rule Group 1\n│   ├── Rule: Block SQLi\n│   └── Rule: Block XSS\n├── Rule Group 2 (Managed)\n│   └── AWS Core Rule Set\n└── Default Action: Allow\n```\n\n### Rule Types\n\n| Type | Use Case |\n|------|----------|\n| Regular | IP, geo, string match |\n| Rate-based | DDoS, brute force |\n| Managed | Pre-built rules |\n\n### Custom Rule Example\n```json\n{\n  "Name": "BlockSQLi",\n  "Priority": 1,\n  "Action": {"Block": {}},\n  "Statement": {\n    "SqliMatchStatement": {\n      "FieldToMatch": {\n        "QueryString": {}\n      },\n      "TextTransformations": [{\n        "Priority": 0,\n        "Type": "URL_DECODE"\n      }]\n    }\n  }\n}\n```\n\n### Rate-Based Rule\n```json\n{\n  "Name": "RateLimit",\n  "Priority": 2,\n  "Action": {"Block": {}},\n  "Statement": {\n    "RateBasedStatement": {\n      "Limit": 1000,\n      "AggregateKeyType": "IP"\n    }\n  }\n}\n```\n\n## AWS Shield\n\nDDoS protection service.\n\n### Shield Standard (Free)\n- Automatic protection\n- Layer 3/4 attacks\n- All AWS customers\n\n### Shield Advanced\n- Enhanced detection\n- 24/7 DDoS Response Team\n- Cost protection\n- WAF included\n- Real-time metrics\n\n## Integration Points\n\n- Amazon CloudFront\n- Application Load Balancer\n- Amazon API Gateway\n- AWS AppSync\n\n## Bot Control\n\n```json\n{\n  "Name": "BotControl",\n  "Statement": {\n    "ManagedRuleGroupStatement": {\n      "VendorName": "AWS",\n      "Name": "AWSManagedRulesBotControlRuleSet"\n    }\n  }\n}\n```\n\n## Logging and Monitoring\n\n### WAF Logs to S3/CloudWatch\n- Full request details\n- Rule match information\n- Action taken\n\n### Shield Metrics\n- DDoSDetected\n- DDoSAttackBitsPerSecond\n- DDoSAttackPacketsPerSecond\n\n## Best Practices\n\n1. Start with **managed rules**\n2. Use **logging** for tuning\n3. Implement **rate limiting**\n4. Enable **Shield Advanced** for critical apps\n5. Test with **count** mode first', 4, 14),

('869146e3-7723-4ce3-a76a-b21c4c4b9689', 'b8c9d0e1-f2a3-4b4c-5d6e-7f8091021324', 'Secrets Manager Deep Dive', E'# Secrets Manager Deep Dive\n\n## AWS Secrets Manager\n\nSecure storage and automatic rotation of secrets.\n\n### Secret Types\n- Database credentials\n- API keys\n- OAuth tokens\n- SSH keys\n\n## Creating Secrets\n\n```python\nimport boto3\n\nsm = boto3.client("secretsmanager")\n\nsm.create_secret(\n    Name="prod/database/postgres",\n    SecretString=json.dumps({\n        "username": "admin",\n        "password": "supersecret",\n        "host": "db.example.com",\n        "port": 5432\n    }),\n    KmsKeyId="alias/secrets-key",\n    Tags=[\n        {"Key": "Environment", "Value": "Production"}\n    ]\n)\n```\n\n## Retrieving Secrets\n\n```python\nresponse = sm.get_secret_value(\n    SecretId="prod/database/postgres"\n)\nsecret = json.loads(response["SecretString"])\n```\n\n### With Caching\n```python\nfrom aws_secretsmanager_caching import SecretCache\n\ncache = SecretCache()\nsecret = cache.get_secret_string("prod/database/postgres")\n```\n\n## Automatic Rotation\n\n### Rotation Lambda\n```python\ndef lambda_handler(event, context):\n    step = event["Step"]\n    secret_id = event["SecretId"]\n    \n    if step == "createSecret":\n        # Create new secret version\n        pass\n    elif step == "setSecret":\n        # Update the service\n        pass\n    elif step == "testSecret":\n        # Verify it works\n        pass\n    elif step == "finishSecret":\n        # Mark as current\n        pass\n```\n\n### Rotation Schedule\n```python\nsm.rotate_secret(\n    SecretId="prod/database/postgres",\n    RotationLambdaARN="arn:aws:lambda:...:rotation",\n    RotationRules={\n        "AutomaticallyAfterDays": 30\n    }\n)\n```\n\n## Cross-Account Access\n\n### Resource Policy\n```json\n{\n  "Version": "2012-10-17",\n  "Statement": [{\n    "Effect": "Allow",\n    "Principal": {\n      "AWS": "arn:aws:iam::OTHER_ACCOUNT:role/AppRole"\n    },\n    "Action": "secretsmanager:GetSecretValue",\n    "Resource": "*",\n    "Condition": {\n      "StringEquals": {\n        "secretsmanager:ResourceTag/Shared": "true"\n      }\n    }\n  }]\n}\n```\n\n## Integration Patterns\n\n### ECS/Fargate\n```json\n{\n  "containerDefinitions": [{\n    "secrets": [{\n      "name": "DB_PASSWORD",\n      "valueFrom": "arn:aws:secretsmanager:...:prod/db"\n    }]\n  }]\n}\n```\n\n### Lambda\n```yaml\nEnvironment:\n  Variables:\n    DB_SECRET_ARN: !Ref DatabaseSecret\n```\n\n## Best Practices\n\n1. Use **automatic rotation**\n2. Apply **least privilege** access\n3. Use **resource policies** for sharing\n4. Enable **CloudTrail logging**\n5. Implement **caching** in apps', 5, 14),

('10ca1a45-4681-43d5-ad64-0fd8f684d2bc', 'b8c9d0e1-f2a3-4b4c-5d6e-7f8091021324', 'Incident Response in AWS', E'# Incident Response in AWS\n\n## IR Framework for Cloud\n\n### NIST Incident Response Lifecycle\n\n```\n┌──────────────┐\n│ Preparation  │\n└──────┬───────┘\n       │\n┌──────▼───────┐\n│  Detection   │\n│    and       │\n│  Analysis    │\n└──────┬───────┘\n       │\n┌──────▼───────┐\n│ Containment, │\n│ Eradication, │\n│  Recovery    │\n└──────┬───────┘\n       │\n┌──────▼───────┐\n│Post-Incident │\n│  Activity    │\n└──────────────┘\n```\n\n## Preparation\n\n### IR Runbooks\n```yaml\nRunbook: Compromised EC2\nSteps:\n  1. Isolate instance (change SG)\n  2. Capture memory/disk\n  3. Preserve logs\n  4. Terminate if necessary\n  5. Analyze artifacts\n  6. Remediate root cause\n```\n\n### Pre-deployed Resources\n- Forensics VPC\n- Isolated security groups\n- IR IAM roles\n- Automation scripts\n\n## Detection\n\n### Detection Sources\n- GuardDuty findings\n- Security Hub alerts\n- CloudWatch alarms\n- Third-party tools\n\n### Automated Alerting\n```python\n# EventBridge rule for critical findings\n{\n    "source": ["aws.guardduty"],\n    "detail-type": ["GuardDuty Finding"],\n    "detail": {\n        "severity": [{"numeric": [">=", 7]}]\n    }\n}\n```\n\n## Containment\n\n### Network Isolation\n```python\n# Replace security group with isolated one\nec2.modify_instance_attribute(\n    InstanceId=instance_id,\n    Groups=["sg-isolated"]\n)\n```\n\n### Forensic Snapshot\n```python\n# Create snapshots of all volumes\nvolumes = ec2.describe_volumes(\n    Filters=[{"Name": "attachment.instance-id", \n              "Values": [instance_id]}]\n)\nfor vol in volumes["Volumes"]:\n    ec2.create_snapshot(\n        VolumeId=vol["VolumeId"],\n        Description=f"IR-{incident_id}"\n    )\n```\n\n## Evidence Collection\n\n### CloudTrail Logs\n```sql\nSELECT *\nFROM cloudtrail_logs\nWHERE useridentity.arn LIKE ''%compromised-role%''\nAND eventtime >= ''2024-01-15''\n```\n\n### VPC Flow Logs\n```sql\nSELECT srcaddr, dstaddr, dstport, action\nFROM vpc_flow_logs\nWHERE srcaddr = ''10.0.1.50''\nAND action = ''ACCEPT''\n```\n\n## Recovery\n\n1. Rebuild from clean AMI\n2. Rotate all credentials\n3. Patch vulnerabilities\n4. Restore from backup\n5. Validate security controls\n\n## Best Practices\n\n1. Have **documented runbooks**\n2. Practice with **GameDays**\n3. Automate **containment**\n4. Preserve **evidence** first\n5. Conduct **post-mortems**', 6, 14),

('81ebe739-8dca-49bd-bca5-d9322d4c0076', 'b8c9d0e1-f2a3-4b4c-5d6e-7f8091021324', 'Security Automation with Lambda', E'# Security Automation with Lambda\n\n## Security Automation Patterns\n\n### Event-Driven Security\n\n```\n┌─────────────┐     ┌────────────┐     ┌─────────┐\n│ CloudTrail  │────▶│EventBridge │────▶│ Lambda  │\n│  Event      │     │   Rule     │     │ Function│\n└─────────────┘     └────────────┘     └────┬────┘\n                                            │\n                                    ┌───────┴───────┐\n                                    │   Remediate   │\n                                    └───────────────┘\n```\n\n## Auto-Remediation Examples\n\n### Public S3 Bucket\n```python\nimport boto3\n\ns3 = boto3.client("s3")\n\ndef handler(event, context):\n    bucket = event["detail"]["resourcesAffected"][\n        "s3Bucket"]["name"]\n    \n    # Block public access\n    s3.put_public_access_block(\n        Bucket=bucket,\n        PublicAccessBlockConfiguration={\n            "BlockPublicAcls": True,\n            "IgnorePublicAcls": True,\n            "BlockPublicPolicy": True,\n            "RestrictPublicBuckets": True\n        }\n    )\n    \n    # Notify security team\n    notify_security(bucket)\n```\n\n### Exposed Security Group\n```python\ndef remediate_open_sg(event, context):\n    sg_id = event["detail"]["findings"][0][\n        "Resources"][0]["Id"]\n    \n    ec2 = boto3.client("ec2")\n    \n    # Remove 0.0.0.0/0 rules\n    ec2.revoke_security_group_ingress(\n        GroupId=sg_id,\n        IpPermissions=[{\n            "IpProtocol": "-1",\n            "IpRanges": [{"CidrIp": "0.0.0.0/0"}]\n        }]\n    )\n```\n\n### IAM Key Age\n```python\ndef rotate_old_keys(event, context):\n    iam = boto3.client("iam")\n    users = iam.list_users()["Users"]\n    \n    for user in users:\n        keys = iam.list_access_keys(\n            UserName=user["UserName"]\n        )["AccessKeyMetadata"]\n        \n        for key in keys:\n            age = (datetime.now(timezone.utc) - \n                   key["CreateDate"]).days\n            if age > 90:\n                iam.update_access_key(\n                    UserName=user["UserName"],\n                    AccessKeyId=key["AccessKeyId"],\n                    Status="Inactive"\n                )\n```\n\n## Compliance Automation\n\n### AWS Config Custom Rules\n```python\ndef evaluate_compliance(config_item):\n    if config_item["resourceType"] == "AWS::EC2::Volume":\n        if not config_item["configuration"]["encrypted"]:\n            return "NON_COMPLIANT"\n    return "COMPLIANT"\n```\n\n## Security Chatbot\n\n```python\ndef slack_alert(event, context):\n    finding = event["detail"]["findings"][0]\n    \n    message = {\n        "text": f"🚨 Security Alert: {finding[''Title'']}",\n        "attachments": [{\n            "color": "danger",\n            "fields": [\n                {"title": "Severity", \n                 "value": finding["Severity"]["Label"]},\n                {"title": "Resource", \n                 "value": finding["Resources"][0]["Id"]}\n            ]\n        }]\n    }\n    \n    requests.post(SLACK_WEBHOOK, json=message)\n```\n\n## Deployment with SAM\n\n```yaml\nAWSTemplateFormatVersion: "2010-09-09"\nTransform: AWS::Serverless-2016-10-31\n\nResources:\n  RemediationFunction:\n    Type: AWS::Serverless::Function\n    Properties:\n      Handler: remediate.handler\n      Runtime: python3.11\n      Events:\n        SecurityHub:\n          Type: EventBridgeRule\n          Properties:\n            Pattern:\n              source: ["aws.securityhub"]\n      Policies:\n        - Version: "2012-10-17"\n          Statement:\n            - Effect: Allow\n              Action: ["s3:PutPublicAccessBlock"]\n              Resource: "*"\n```\n\n## Best Practices\n\n1. Use **least privilege** for Lambda roles\n2. Implement **dry-run** mode first\n3. Add **logging** and metrics\n4. Create **approval workflows** for critical actions\n5. Test automation in **non-prod**', 7, 16);

-- =============================================
-- QUIZ QUESTIONS
-- =============================================

-- GCP Security Fundamentals Quiz Questions
INSERT INTO quiz_questions (id, quiz_id, question_text, options, correct_answer, explanation, order_index, points) VALUES
('53679eb1-b645-49c3-a964-45ce5438b15a', '04d5e6f7-a8b9-4c0d-1e2f-3a4b5c6d7e80', 'What is the GCP shared responsibility model?', '["Google is responsible for everything", "Customer is responsible for everything", "Google secures infrastructure, customer secures workloads", "Third-party manages all security"]', 'Google secures infrastructure, customer secures workloads', 'In the shared responsibility model, Google handles physical security, network infrastructure, and the hypervisor, while customers are responsible for their data, access management, and application security.', 1, 1),
('6c4613f1-4405-4fc1-8355-985a6d9feef8', '04d5e6f7-a8b9-4c0d-1e2f-3a4b5c6d7e80', 'Which IAM member type represents an application identity?', '["Google Account", "Service Account", "Google Group", "allUsers"]', 'Service Account', 'Service Accounts are used for application identities, allowing applications to authenticate to GCP services without user credentials.', 2, 1),
('66f87d5d-6507-4a9c-bc37-33e403e5670f', '04d5e6f7-a8b9-4c0d-1e2f-3a4b5c6d7e80', 'What is the default firewall rule priority range in GCP?', '["0 to 100", "0 to 1000", "0 to 65535", "1 to 10000"]', '0 to 65535', 'GCP firewall rules use priorities from 0 to 65535, where lower numbers indicate higher priority.', 3, 1),
('07008ca4-5ea9-4f0d-a2d4-e557f1ffb422', '04d5e6f7-a8b9-4c0d-1e2f-3a4b5c6d7e80', 'Which encryption option allows you to manage keys in Cloud KMS?', '["Google-managed", "Customer-managed (CMEK)", "Customer-supplied (CSEK)", "No encryption"]', 'Customer-managed (CMEK)', 'Customer-managed encryption keys (CMEK) let you control keys in Cloud KMS while Google handles the encryption operations.', 4, 1),
('98ce8e77-5462-4f21-ae4e-bb08e81eace8', '04d5e6f7-a8b9-4c0d-1e2f-3a4b5c6d7e80', 'Which Cloud Audit Log type is always enabled by default?', '["Data Access logs", "Admin Activity logs", "Custom logs", "Application logs"]', 'Admin Activity logs', 'Admin Activity logs are always enabled and cannot be disabled. They record configuration changes to GCP resources.', 5, 1),
('75bf483d-6f58-4d57-9e68-af0c5fcdcd18', '04d5e6f7-a8b9-4c0d-1e2f-3a4b5c6d7e80', 'What service provides centralized security posture management in GCP?', '["Cloud IAM", "Security Command Center", "Cloud Armor", "VPC Service Controls"]', 'Security Command Center', 'Security Command Center provides asset inventory, vulnerability detection, threat detection, and compliance monitoring.', 6, 1),
('5b32afbf-4730-4afa-aeb8-56260f64703d', '04d5e6f7-a8b9-4c0d-1e2f-3a4b5c6d7e80', 'What is the purpose of VPC Service Controls?', '["Block DDoS attacks", "Prevent data exfiltration", "Manage user access", "Monitor network traffic"]', 'Prevent data exfiltration', 'VPC Service Controls create security perimeters around GCP resources to prevent data exfiltration.', 7, 1),
('f5ebd414-fe7e-4c56-af8d-ca4c63e313a2', '04d5e6f7-a8b9-4c0d-1e2f-3a4b5c6d7e80', 'Which storage class is best for frequently accessed data?', '["Archive", "Coldline", "Nearline", "Standard"]', 'Standard', 'Standard storage class offers 99.99% availability and is designed for frequently accessed data.', 8, 1),
('f5a08753-dc09-41ce-8747-00301784007c', '04d5e6f7-a8b9-4c0d-1e2f-3a4b5c6d7e80', 'What is the recommended approach for bucket access control?', '["Fine-grained with ACLs", "Uniform bucket-level access", "Public access", "No access control"]', 'Uniform bucket-level access', 'Uniform bucket-level access is the recommended approach, using only IAM for access control.', 9, 1),
('989a56f0-bcde-4e61-97db-ba71e163ecfc', '04d5e6f7-a8b9-4c0d-1e2f-3a4b5c6d7e80', 'Which role type allows creating user-defined permissions?', '["Basic roles", "Predefined roles", "Custom roles", "Primitive roles"]', 'Custom roles', 'Custom roles allow you to define your own set of permissions for granular access control.', 10, 1);

-- Kubernetes Security Quiz Questions
INSERT INTO quiz_questions (id, quiz_id, question_text, options, correct_answer, explanation, order_index, points) VALUES
('0d7f5c3c-60c9-44fa-a33d-391605be6cdb', '05e6f7a8-b9c0-4d1e-2f3a-4b5c6d7e8f91', 'What are the 4Cs of Cloud Native Security?', '["Code, Container, Cluster, Cloud", "Code, Configuration, Compliance, Cloud", "Container, Cluster, Control, Compliance", "Code, Container, Control, Cloud"]', 'Code, Container, Cluster, Cloud', 'The 4Cs represent security layers from inner to outer: Code, Container, Cluster, and Cloud.', 1, 1),
('d9202f83-505e-467d-839c-b6bf2fb3429f', '05e6f7a8-b9c0-4d1e-2f3a-4b5c6d7e8f91', 'What is the difference between Role and ClusterRole in RBAC?', '["Role is for users, ClusterRole is for services", "Role is namespace-scoped, ClusterRole is cluster-wide", "Role is read-only, ClusterRole has write access", "They are identical"]', 'Role is namespace-scoped, ClusterRole is cluster-wide', 'Role defines permissions within a specific namespace, while ClusterRole defines permissions across the entire cluster.', 2, 1),
('485bec74-cfab-468b-b518-6bcdb1989599', '05e6f7a8-b9c0-4d1e-2f3a-4b5c6d7e8f91', 'What is the most restrictive Pod Security Standard level?', '["Privileged", "Baseline", "Restricted", "Standard"]', 'Restricted', 'The Restricted level enforces hardened security best practices like running as non-root and dropping all capabilities.', 3, 1),
('4616fae0-1e13-444c-9437-29f37765e4eb', '05e6f7a8-b9c0-4d1e-2f3a-4b5c6d7e8f91', 'What happens by default with Kubernetes networking between pods?', '["All pods are isolated", "All pods can communicate with each other", "Only same-namespace pods can communicate", "No networking is enabled"]', 'All pods can communicate with each other', 'By default, Kubernetes allows all pods to communicate with all other pods, which is why Network Policies are important.', 4, 1),
('267a5b0f-97d3-4d85-9f6d-c3ae7f011ebb', '05e6f7a8-b9c0-4d1e-2f3a-4b5c6d7e8f91', 'What is the main limitation of Kubernetes native Secrets?', '["Cannot store passwords", "Base64 encoded, not encrypted", "Maximum 1KB size", "Cannot be mounted as volumes"]', 'Base64 encoded, not encrypted', 'Kubernetes Secrets are only base64 encoded by default, not encrypted. You must enable encryption at rest.', 5, 1),
('22575639-025c-4518-9eab-0e93bc2d1719', '05e6f7a8-b9c0-4d1e-2f3a-4b5c6d7e8f91', 'Which tool uses eBPF for runtime security in Kubernetes?', '["Trivy", "Falco", "Cosign", "OPA"]', 'Falco', 'Falco is an open-source runtime security tool that uses eBPF to detect anomalous behavior.', 6, 1),
('704f16e7-af19-41d7-b5a9-f5ea78356b01', '05e6f7a8-b9c0-4d1e-2f3a-4b5c6d7e8f91', 'What security context setting prevents privilege escalation?', '["runAsNonRoot", "allowPrivilegeEscalation: false", "readOnlyRootFilesystem", "capabilities: drop ALL"]', 'allowPrivilegeEscalation: false', 'Setting allowPrivilegeEscalation to false prevents a process from gaining more privileges than its parent.', 7, 1),
('9ff9b192-bd3e-4147-b35b-cbb45983c667', '05e6f7a8-b9c0-4d1e-2f3a-4b5c6d7e8f91', 'Which CNI does NOT support Network Policies?', '["Calico", "Cilium", "Weave Net", "Flannel"]', 'Flannel', 'Flannel is a simple CNI that does not support Network Policies.', 8, 1),
('624f2804-1f54-4982-9a2a-97f070337ab9', '05e6f7a8-b9c0-4d1e-2f3a-4b5c6d7e8f91', 'What is the best practice for service account tokens?', '["Always mount them automatically", "Disable automatic mounting", "Share across namespaces", "Use default service account"]', 'Disable automatic mounting', 'Best practice is to set automountServiceAccountToken: false and only mount tokens when needed.', 9, 1),
('877a3da3-7f8a-4e38-9a68-7044565f1384', '05e6f7a8-b9c0-4d1e-2f3a-4b5c6d7e8f91', 'What tool is used to sign container images?', '["Trivy", "Falco", "Cosign", "Grype"]', 'Cosign', 'Cosign is used to sign and verify container images, ensuring image integrity and provenance.', 10, 1),
('c555bda8-4c57-44d9-ac4f-145bef28666c', '05e6f7a8-b9c0-4d1e-2f3a-4b5c6d7e8f91', 'What should be the first step when implementing Network Policies?', '["Allow all traffic", "Block specific IPs", "Start with default deny", "Enable DNS only"]', 'Start with default deny', 'Best practice is to start with a default deny policy and then explicitly allow only required traffic.', 11, 1),
('4934c429-e97c-4edd-bbaa-337f4554de5e', '05e6f7a8-b9c0-4d1e-2f3a-4b5c6d7e8f91', 'Which external secret manager is provided by AWS?', '["HashiCorp Vault", "AWS Secrets Manager", "Azure Key Vault", "GCP Secret Manager"]', 'AWS Secrets Manager', 'AWS Secrets Manager is the AWS-native service for managing secrets with automatic rotation.', 12, 1);

-- Zero Trust Architecture Quiz Questions
INSERT INTO quiz_questions (id, quiz_id, question_text, options, correct_answer, explanation, order_index, points) VALUES
('e8f474d6-0f77-496e-a984-cef8b73679a8', '06f7a8b9-c0d1-4e2f-3a4b-5c6d7e8f9012', 'What is the core principle of Zero Trust?', '["Trust but verify", "Never trust, always verify", "Trust internal networks", "Verify once at login"]', 'Never trust, always verify', 'Zero Trust is based on never trusting any user, device, or network by default and always verifying.', 1, 1),
('04ac2c9e-9265-4158-92cb-67cd5ba7e5ca', '06f7a8b9-c0d1-4e2f-3a4b-5c6d7e8f9012', 'What replaces network location as the security boundary in Zero Trust?', '["Firewall", "Identity", "VPN", "Perimeter"]', 'Identity', 'In Zero Trust, identity becomes the new perimeter, replacing traditional network location.', 2, 1),
('24e92d40-efcc-4f95-b2e8-4052c58607d0', '06f7a8b9-c0d1-4e2f-3a4b-5c6d7e8f9012', 'What type of MFA is considered phishing-resistant?', '["SMS codes", "Email codes", "FIDO2/WebAuthn", "Time-based OTP"]', 'FIDO2/WebAuthn', 'FIDO2/WebAuthn uses cryptographic authentication tied to the specific website, making it resistant to phishing.', 3, 1),
('72fce1fe-f74b-411e-a4eb-d3a49465aedb', '06f7a8b9-c0d1-4e2f-3a4b-5c6d7e8f9012', 'What is micro-segmentation?', '["Large network segments", "Dividing network into small isolated segments", "Removing all segmentation", "VPN segmentation"]', 'Dividing network into small isolated segments', 'Micro-segmentation divides the network into small, isolated segments with individual security controls.', 4, 1),
('080cbe10-f7a7-4f63-98b8-64c93b9d984a', '06f7a8b9-c0d1-4e2f-3a4b-5c6d7e8f9012', 'What does JIT access stand for?', '["Just-in-time", "Joint identity token", "JavaScript integration testing", "Joined identity trust"]', 'Just-in-time', 'Just-in-time (JIT) access provides temporary access only when needed, reducing attack surface.', 5, 1),
('ab91562a-4d93-46f9-af8a-95409d8e0cfd', '06f7a8b9-c0d1-4e2f-3a4b-5c6d7e8f9012', 'What is continuous verification in Zero Trust?', '["Verifying once per day", "Ongoing validation throughout the session", "Annual security review", "Verification only at login"]', 'Ongoing validation throughout the session', 'Continuous verification means constantly validating user and device context throughout the session.', 6, 1),
('c1ce3f24-5929-4207-b363-5d795754e6dd', '06f7a8b9-c0d1-4e2f-3a4b-5c6d7e8f9012', 'Which AWS service provides Zero Trust application access?', '["AWS VPN", "AWS Verified Access", "AWS Direct Connect", "AWS PrivateLink"]', 'AWS Verified Access', 'AWS Verified Access provides secure access to applications without VPN, using identity and device posture.', 7, 1),
('a3b132f0-a5c8-4ac8-a7f1-652eab70c79c', '06f7a8b9-c0d1-4e2f-3a4b-5c6d7e8f9012', 'What is the purpose of UEBA in Zero Trust?', '["User authentication", "Behavior analytics for anomaly detection", "Encryption", "Network routing"]', 'Behavior analytics for anomaly detection', 'User Entity Behavior Analytics (UEBA) detects anomalous behavior patterns indicating compromise.', 8, 1),
('97f8f2a9-52fb-47f5-a060-38b51772bbbe', '06f7a8b9-c0d1-4e2f-3a4b-5c6d7e8f9012', 'What is the assume breach principle?', '["Assume networks are secure", "Minimize blast radius assuming breach will occur", "Trust verified users completely", "Ignore potential breaches"]', 'Minimize blast radius assuming breach will occur', 'Assume breach means designing security assuming attackers will gain access, focusing on limiting damage.', 9, 1),
('dc99f262-c2bf-4eff-b2e1-d06f49ade70c', '06f7a8b9-c0d1-4e2f-3a4b-5c6d7e8f9012', 'Which component makes access decisions in Zero Trust architecture?', '["Firewall", "Policy Engine", "VPN Gateway", "Load Balancer"]', 'Policy Engine', 'The Policy Engine evaluates identity, device, context, and risk to make access decisions.', 10, 1);

-- Cloud Compliance Quiz Questions
INSERT INTO quiz_questions (id, quiz_id, question_text, options, correct_answer, explanation, order_index, points) VALUES
('22a331d0-5a51-498b-81b1-3c0d7cc3446e', '07a8b9c0-d1e2-4f3a-4b5c-6d7e8f901223', 'What is the shared responsibility model in cloud compliance?', '["Provider handles all compliance", "Customer handles all compliance", "Responsibilities are divided between provider and customer", "Third parties handle compliance"]', 'Responsibilities are divided between provider and customer', 'The shared responsibility model divides compliance responsibilities between provider and customer.', 1, 1),
('11c84255-39db-4c73-9ab4-32f01c2011f7', '07a8b9c0-d1e2-4f3a-4b5c-6d7e8f901223', 'Which regulation protects personal data of EU residents?', '["HIPAA", "PCI DSS", "GDPR", "SOC 2"]', 'GDPR', 'The General Data Protection Regulation (GDPR) protects personal data of EU residents.', 2, 1),
('5d7030a9-2ad2-4953-9684-e68d013381ee', '07a8b9c0-d1e2-4f3a-4b5c-6d7e8f901223', 'What is the right to erasure also known as?', '["Right to access", "Right to be forgotten", "Right to portability", "Right to object"]', 'Right to be forgotten', 'The right to erasure allows individuals to request deletion of their personal data.', 3, 1),
('69170ed9-8800-435d-9fb7-149f84c43af5', '07a8b9c0-d1e2-4f3a-4b5c-6d7e8f901223', 'Which SOC 2 Trust Services Criterion is required?', '["Availability", "Confidentiality", "Security", "Privacy"]', 'Security', 'Security is the only required Trust Services Criterion in SOC 2.', 4, 1),
('996e0e07-f18f-44ff-842e-c8400f85d688', '07a8b9c0-d1e2-4f3a-4b5c-6d7e8f901223', 'What is the difference between SOC 2 Type I and Type II?', '["Type I is for small companies", "Type II covers a period of time vs Type I point-in-time", "Type I is more comprehensive", "No difference"]', 'Type II covers a period of time vs Type I point-in-time', 'SOC 2 Type I is point-in-time, while Type II covers 6-12 months of control operation.', 5, 1),
('1c0bb614-4bc2-45af-9bfe-4d17df7a6b2e', '07a8b9c0-d1e2-4f3a-4b5c-6d7e8f901223', 'What does ISO 27001 certify?', '["Payment card security", "Information Security Management System", "Healthcare data protection", "Cloud infrastructure"]', 'Information Security Management System', 'ISO 27001 certifies an Information Security Management System (ISMS).', 6, 1),
('3ac739b7-982d-42e9-9bd9-26af6f2ea914', '07a8b9c0-d1e2-4f3a-4b5c-6d7e8f901223', 'What must NEVER be stored after payment authorization per PCI DSS?', '["PAN (card number)", "Cardholder name", "Sensitive authentication data (CVV, PIN)", "Expiration date"]', 'Sensitive authentication data (CVV, PIN)', 'PCI DSS prohibits storing CVV, full magnetic stripe, and PIN after authorization.', 7, 1),
('16e631fd-e790-49a1-b147-d31ec88cb9d6', '07a8b9c0-d1e2-4f3a-4b5c-6d7e8f901223', 'What is tokenization in PCI DSS?', '["Encrypting card data", "Replacing PAN with a non-sensitive token", "Storing cards in tokens", "Authentication method"]', 'Replacing PAN with a non-sensitive token', 'Tokenization replaces the Primary Account Number with a non-sensitive token.', 8, 1);

-- Note: Additional quiz questions for Cloud Security Fundamentals, AWS Security, and Azure Security quizzes
-- would be inserted here following the same pattern. The file is already quite large,
-- so adding placeholders for these quizzes.

-- End of database seed file
